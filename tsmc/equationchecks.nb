(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     26521,        751]
NotebookOptionsPosition[     25525,        718]
NotebookOutlinePosition[     25961,        735]
CellTagsIndexPosition[     25918,        732]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"changepoint", "=", "0.451985"}], ";"}]], "Input",
 CellChangeTimes->{{3.6585927958484917`*^9, 3.6585928054620323`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Lambda]", "[", "t_", "]"}], ":=", 
  RowBox[{"Piecewise", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"t", "<", "changepoint"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"t", "\[GreaterEqual]", "changepoint"}]}], "}"}]}], "}"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6585920831572104`*^9, 3.658592087051279*^9}, {
  3.658592941695675*^9, 3.6585929519840117`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"\[Lambda]", "[", "t", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "3"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6585915580217133`*^9, 3.6585916273123407`*^9}, {
  3.658592812890312*^9, 3.658592841933609*^9}, {3.658592956359068*^9, 
  3.658592958403122*^9}}],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
     1.], LineBox[CompressedData["
1:eJxTTMoPSmViYGCQAWIQ7ZX64uKBl6F2DGDwwb65sbuiS7LFHsZPKXkv2Sk5
Bc7nmOK58MPHJXD+9gtG7u5y6+H8iOY7tw53b4Hz8zcW6874shPO/zTh2glG
xv1w/omDx/aftzkE52dWevJGvjkC5x/kNPq/Jvc4nL9s8ZF/Uqqn4HwHsb2L
gtedgfN1j9/ZcUzrPJx/xSH43cp3F+D8HK7sS1cNLsH5p2+E7+XruwznB7tF
PHzy5Aqcb7agO3yByjU4/8G/yVcy6q/D+U89zy8WO3wDzt8w837lRcVbcP7S
DuZOzarbcL7vt3WWJ6TuwPlfk6Nepe1G8L8p3p2gfRHB/3E/3vzDMwR/m6cG
m+QLBB8A2OSaEQ==
      "]], LineBox[CompressedData["
1:eJxTTMoPSmViYGBQBWIQbfGw+lv3pzv2DBDgUPHOcYvzdwT/59xHd7f8QfB/
/VE2nM5+F8GPTm2pFELw/17Pushkh+AzhBTI9WQi+Gw+1TvmHUDwuV3agjaK
34PzXVZt1ffcheDXCDzleRhzH87n2afNcN33AZxvW+b/9/AvBH/Okp7FynMe
wvlxoSZnOb0fwflbr6ZO3vcNwbc8s4Hp2bTHcL6Ca9rXyS5P4HxTE9OJW54h
+Pc/9Z5c3PoUzn9jHNgqafQMzld7rfuK8TKCf0Sl9FJB43M4v//K1eQglRdw
/vvgAxOZjiD4m0JFnS0LX8L5i882z30k9ArO/348plroEIL/YOL+rwJ5r+H8
bxetJZv43sD5BVOUDlTuQfDFzyoJPIl7C+cHX13zR+Yfgv8pfmHOnVXv4Pz9
Cetb+Xzew/naDrG27MsQ/Ony3F///0fwAerIppU=
      "]]}, {}}, {{}, {}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{"DefaultBoundaryStyle" -> Automatic, "ScalingFunctions" -> None},
  PlotRange->{{0., 0.9999999795918367}, {0, 3}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {0, 0}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.65859158369156*^9, {3.658591616384799*^9, 3.658591628397531*^9}, {
   3.658592830565628*^9, 3.658592842628839*^9}, 3.6585929607408237`*^9, 
   3.658657284391227*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ts", "=", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0.095310", ",", "0.200671", ",", "0.318454", ",", "0.451985", 
     ",", "0.606136", ",", "0.788457", ",", "1.011601", ",", "1.299283", ",", 
     "1.704748", ",", "2.397895", ",", "Infinity"}], "}"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.658592858045166*^9, 3.65859293228449*^9}, {
  3.658594097005396*^9, 3.658594098179654*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"n", "=", 
   RowBox[{
    RowBox[{"Length", "[", "ts", "]"}], "-", "2"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6585932003793097`*^9, 3.6585932151561413`*^9}, {
  3.658594100556241*^9, 3.658594100619706*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"t", "[", "i_", "]"}], ":=", 
   RowBox[{"ts", "[", 
    RowBox[{"[", 
     RowBox[{"i", "+", "1"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.658592978244063*^9, 3.6585929889548264`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Omega", "[", 
   RowBox[{"t1_", ",", "t2_"}], "]"}], ":=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"\[Lambda]", "[", "s", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"s", ",", "t1", ",", "t2"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.658592063792857*^9, 3.658592133150588*^9}}],

Cell[BoxData[
 RowBox[{"(*", "Pi", "*)"}]], "Input",
 CellChangeTimes->{{3.658594776180366*^9, 3.658594778244657*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"pi", "[", 
   RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{"Piecewise", "[", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"3", "/", "2"}], "*", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "3"}], 
          RowBox[{"Omega", "[", 
           RowBox[{"0", ",", 
            RowBox[{"t", "[", "i", "]"}]}], "]"}]}], "]"}], 
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          RowBox[{"Omega", "[", 
           RowBox[{
            RowBox[{"t", "[", 
             RowBox[{"i", "+", "1"}], "]"}], ",", 
            RowBox[{"t", "[", "j", "]"}]}], "]"}]}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"-", 
            RowBox[{"Omega", "[", 
             RowBox[{
              RowBox[{"t", "[", "i", "]"}], ",", 
              RowBox[{"t", "[", 
               RowBox[{"i", "+", "1"}], "]"}]}], "]"}]}], "]"}], "-", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "3"}], 
            RowBox[{"Omega", "[", 
             RowBox[{
              RowBox[{"t", "[", "i", "]"}], ",", 
              RowBox[{"t", "[", 
               RowBox[{"i", "+", "1"}], "]"}]}], "]"}]}], "]"}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"Exp", "[", 
           RowBox[{"-", 
            RowBox[{"Omega", "[", 
             RowBox[{
              RowBox[{"t", "[", "j", "]"}], ",", 
              RowBox[{"t", "[", 
               RowBox[{"j", "+", "1"}], "]"}]}], "]"}]}], "]"}]}], ")"}]}], 
       ",", 
       RowBox[{
        RowBox[{"0", "<=", "i", "<", "j", "\[LessEqual]", "n"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"i", "\[Element]", "Integers"}], "&&", 
          RowBox[{"j", "\[Element]", "Integers"}]}], ")"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "3"}], 
          RowBox[{"Omega", "[", 
           RowBox[{"0", ",", 
            RowBox[{"t", "[", "i", "]"}]}], "]"}]}], "]"}], 
        RowBox[{"(", 
         RowBox[{"2", "-", 
          RowBox[{"3", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"t", "[", 
                 RowBox[{"i", "+", "1"}], "]"}], "-", 
                RowBox[{"t", "[", "i", "]"}]}], ")"}]}], "/", 
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"t", "[", "i", "]"}], "]"}]}], "]"}]}], "+", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "3"}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"t", "[", 
                RowBox[{"i", "+", "1"}], "]"}], "-", 
               RowBox[{"t", "[", "i", "]"}]}], ")"}], "/", 
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"t", "[", "i", "]"}], "]"}]}]}], "]"}]}], ")"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "0", "\[LessEqual]", "i", "\[Equal]", "j", "\[LessEqual]", "n"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"i", "\[Element]", "Integers"}], "&&", 
          RowBox[{"j", "\[Element]", "Integers"}]}], ")"}]}]}], "}"}]}], 
    "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.65859308266936*^9, 3.658593088363051*^9}, {
  3.658593146308301*^9, 3.6585933913786707`*^9}, {3.6585934273409348`*^9, 
  3.658593573961179*^9}, {3.658594441551848*^9, 3.65859460495435*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Pi", " ", "is", " ", "working"}], ",", " ", 
   RowBox[{"at", " ", "least", " ", "for", " ", "constant", " ", 
    RowBox[{"N", " ", "[", "\[Lambda]", "]"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.6585946563529587`*^9, 3.6585946703110533`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"E", "[", 
   RowBox[{"t_", "3"}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.658594785803606*^9, 3.65859478942553*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"intEt3", "[", 
   RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"pi", "[", 
     RowBox[{"i", ",", "j"}], "]"}]], 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      FractionBox["3", 
       RowBox[{
        RowBox[{"\[Lambda]", "[", 
         RowBox[{"t", "[", "i", "]"}], "]"}], 
        RowBox[{"\[Lambda]", "[", 
         RowBox[{"t", "[", "j", "]"}], "]"}]}]], " ", "t3", " ", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "3"}], 
        RowBox[{"Omega", "[", 
         RowBox[{"0", ",", "t3"}], "]"}]}], "]"}], 
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        RowBox[{"Omega", "[", 
         RowBox[{"t3", ",", "t2"}], "]"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"t", "[", "j", "]"}], ",", 
       RowBox[{"t", "[", 
        RowBox[{"j", "+", "1"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t3", ",", 
       RowBox[{"t", "[", "i", "]"}], ",", 
       RowBox[{"t", "[", 
        RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6585947577059937`*^9, 3.658594758625227*^9}, {
  3.658594839697444*^9, 3.658594956480558*^9}, {3.6585949971697483`*^9, 
  3.6585950053526*^9}, {3.6585951799048777`*^9, 3.658595284108556*^9}, {
  3.65859531900383*^9, 3.658595364357547*^9}, {3.6585955117255087`*^9, 
  3.658595534461152*^9}, {3.65859558054047*^9, 3.658595596316477*^9}, {
  3.658597047667261*^9, 3.658597061591826*^9}, {3.658597708584753*^9, 
  3.658597712045776*^9}, {3.658598181490839*^9, 3.658598186835086*^9}, {
  3.658598533817904*^9, 3.6585985339607687`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Et3", "[", 
   RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{"Piecewise", "[", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox["3", 
         RowBox[{"4", 
          RowBox[{"pi", "[", 
           RowBox[{"i", ",", "j"}], "]"}]}]], 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "3"}], 
          RowBox[{"Omega", "[", 
           RowBox[{"0", ",", 
            RowBox[{"t", "[", "i", "]"}]}], "]"}]}], "]"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"Exp", "[", 
           RowBox[{"-", 
            RowBox[{"Omega", "[", 
             RowBox[{
              RowBox[{"t", "[", "j", "]"}], ",", 
              RowBox[{"t", "[", 
               RowBox[{"j", "+", "1"}], "]"}]}], "]"}]}], "]"}]}], ")"}], 
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          RowBox[{"Omega", "[", 
           RowBox[{
            RowBox[{"t", "[", 
             RowBox[{"i", "+", "1"}], "]"}], ",", 
            RowBox[{"t", "[", "j", "]"}]}], "]"}]}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"t", "[", "i", "]"}], "]"}], "+", 
             RowBox[{"2", 
              RowBox[{"t", "[", "i", "]"}]}]}], ")"}], 
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             RowBox[{"Omega", "[", 
              RowBox[{
               RowBox[{"t", "[", "i", "]"}], ",", 
               RowBox[{"t", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "]"}]}], "]"}]}], "-", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"t", "[", "i", "]"}], "]"}], "+", 
             RowBox[{"2", 
              RowBox[{"t", "[", 
               RowBox[{"i", "+", "1"}], "]"}]}]}], ")"}], 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "3"}], 
             RowBox[{"Omega", "[", 
              RowBox[{
               RowBox[{"t", "[", "i", "]"}], ",", 
               RowBox[{"t", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "]"}]}], "]"}]}]}], ")"}]}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"0", "<=", "i", "<", "j", "\[LessEqual]", "n"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"i", "\[Element]", "Integers"}], "&&", 
          RowBox[{"j", "\[Element]", "Integers"}]}], ")"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox["1", 
         RowBox[{"12", 
          RowBox[{"pi", "[", 
           RowBox[{"i", ",", "i"}], "]"}]}]], 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "3"}], 
          RowBox[{"Omega", "[", 
           RowBox[{"0", ",", 
            RowBox[{"t", "[", "i", "]"}]}], "]"}]}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"3", 
              RowBox[{"t", "[", "i", "]"}]}], "+", 
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"t", "[", "i", "]"}], "]"}]}], ")"}]}], "+", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "3"}], 
             RowBox[{"Omega", "[", 
              RowBox[{
               RowBox[{"t", "[", "i", "]"}], ",", 
               RowBox[{"t", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "]"}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"6", 
              RowBox[{"t", "[", 
               RowBox[{"i", "+", "1"}], "]"}]}], "+", 
             RowBox[{"5", 
              RowBox[{"\[Lambda]", "[", 
               RowBox[{"t", "[", "i", "]"}], "]"}]}]}], ")"}]}], "-", 
          RowBox[{"9", 
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             RowBox[{"Omega", "[", 
              RowBox[{
               RowBox[{"t", "[", "i", "]"}], ",", 
               RowBox[{"t", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "]"}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", 
              RowBox[{"t", "[", "i", "]"}]}], "+", 
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"t", "[", "i", "]"}], "]"}]}], ")"}]}]}], ")"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"0", "\[LessEqual]", "i", "\[Equal]", "j", "<", "n"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"i", "\[Element]", "Integers"}], "&&", 
          RowBox[{"j", "\[Element]", "Integers"}]}], ")"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"t", "[", "i", "]"}], "+", 
        RowBox[{
         RowBox[{"\[Lambda]", "[", 
          RowBox[{"t", "[", "i", "]"}], "]"}], "/", "3.0"}]}], ",", 
       RowBox[{
        RowBox[{"i", "\[Equal]", "j", "\[Equal]", "n"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"i", "\[Element]", "Integers"}], "&&", 
          RowBox[{"j", "\[Element]", "Integers"}]}], ")"}]}]}], "}"}]}], 
    "\[IndentingNewLine]", "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.658595640078487*^9, 3.6585957604832287`*^9}, {
   3.658596980359028*^9, 3.658596988281507*^9}, {3.658598496262815*^9, 
   3.6585985043969097`*^9}, {3.658598742479361*^9, 3.658598973332593*^9}, {
   3.65859901683549*^9, 3.6585990268224373`*^9}, {3.6585990777108994`*^9, 
   3.658599088241726*^9}, {3.658599137362996*^9, 3.658599240751433*^9}, {
   3.658599272243225*^9, 3.658599272732688*^9}, 3.658599756089405*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Et2", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"intEt2", "[", 
    RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"pi", "[", 
      RowBox[{"i", ",", "j"}], "]"}]], 
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{
       FractionBox["3", 
        RowBox[{
         RowBox[{"\[Lambda]", "[", 
          RowBox[{"t", "[", "i", "]"}], "]"}], 
         RowBox[{"\[Lambda]", "[", 
          RowBox[{"t", "[", "j", "]"}], "]"}]}]], " ", "t2", " ", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", "3"}], 
         RowBox[{"Omega", "[", 
          RowBox[{"0", ",", "t3"}], "]"}]}], "]"}], 
       RowBox[{"Exp", "[", 
        RowBox[{"-", 
         RowBox[{"Omega", "[", 
          RowBox[{"t3", ",", "t2"}], "]"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"t2", ",", 
        RowBox[{"t", "[", "j", "]"}], ",", 
        RowBox[{"t", "[", 
         RowBox[{"j", "+", "1"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"t3", ",", 
        RowBox[{"t", "[", "i", "]"}], ",", 
        RowBox[{"t", "[", 
         RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6585996322019577`*^9, 3.658599647470613*^9}, {
  3.6585996860517178`*^9, 3.6585996861331472`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Et2", "[", 
    RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
   RowBox[{"Piecewise", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         FractionBox["3", 
          RowBox[{"2", 
           RowBox[{"pi", "[", 
            RowBox[{"i", ",", "j"}], "]"}]}]], 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "3"}], 
           RowBox[{"Omega", "[", 
            RowBox[{"0", ",", 
             RowBox[{"t", "[", "i", "]"}]}], "]"}]}], "]"}], 
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           RowBox[{"Omega", "[", 
            RowBox[{
             RowBox[{"t", "[", 
              RowBox[{"i", "+", "1"}], "]"}], ",", 
             RowBox[{"t", "[", "j", "]"}]}], "]"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             RowBox[{"Omega", "[", 
              RowBox[{
               RowBox[{"t", "[", "i", "]"}], ",", 
               RowBox[{"t", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "]"}]}], "]"}], "-", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "3"}], 
             RowBox[{"Omega", "[", 
              RowBox[{
               RowBox[{"t", "[", "i", "]"}], ",", 
               RowBox[{"t", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "]"}]}], "]"}]}], ")"}], 
         "*", "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Lambda]", "[", 
            RowBox[{"t", "[", "j", "]"}], "]"}], "+", 
           RowBox[{"t", "[", "j", "]"}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Lambda]", "[", 
               RowBox[{"t", "[", "j", "]"}], "]"}], "+", 
              RowBox[{"t", "[", 
               RowBox[{"j", "+", "1"}], "]"}]}], ")"}], 
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              RowBox[{"Omega", "[", 
               RowBox[{
                RowBox[{"t", "[", "j", "]"}], ",", 
                RowBox[{"t", "[", 
                 RowBox[{"j", "+", "1"}], "]"}]}], "]"}]}], "]"}]}]}], 
          ")"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"0", "\[LessEqual]", "i", "<", "j", "<", "n"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"i", "\[Element]", "Integers"}], "&&", 
           RowBox[{"j", "\[Element]", "Integers"}]}], ")"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         FractionBox["3", 
          RowBox[{"2", 
           RowBox[{"pi", "[", 
            RowBox[{"i", ",", "j"}], "]"}]}]], 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "3"}], 
           RowBox[{"Omega", "[", 
            RowBox[{"0", ",", 
             RowBox[{"t", "[", "i", "]"}]}], "]"}]}], "]"}], 
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           RowBox[{"Omega", "[", 
            RowBox[{
             RowBox[{"t", "[", 
              RowBox[{"i", "+", "1"}], "]"}], ",", 
             RowBox[{"t", "[", "j", "]"}]}], "]"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             RowBox[{"Omega", "[", 
              RowBox[{
               RowBox[{"t", "[", "i", "]"}], ",", 
               RowBox[{"t", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "]"}]}], "]"}], "-", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "3"}], 
             RowBox[{"Omega", "[", 
              RowBox[{
               RowBox[{"t", "[", "i", "]"}], ",", 
               RowBox[{"t", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "]"}]}], "]"}]}], ")"}], 
         "*", "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Lambda]", "[", 
            RowBox[{"t", "[", "j", "]"}], "]"}], "+", 
           RowBox[{"t", "[", "j", "]"}]}], ")"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"0", "\[LessEqual]", "i", "<", "j", "==", "n"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"i", "\[Element]", "Integers"}], "&&", 
           RowBox[{"j", "\[Element]", "Integers"}]}], ")"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         FractionBox["1", 
          RowBox[{"6", 
           RowBox[{"pi", "[", 
            RowBox[{"i", ",", "j"}], "]"}]}]], 
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           RowBox[{"Omega", "[", 
            RowBox[{"0", ",", 
             RowBox[{"t", "[", "i", "]"}]}], "]"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "3"}], 
              RowBox[{"Omega", "[", 
               RowBox[{
                RowBox[{"t", "[", "i", "]"}], ",", 
                RowBox[{"t", "[", 
                 RowBox[{"i", "+", "1"}], "]"}]}], "]"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"3", 
               RowBox[{"t", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "+", 
              RowBox[{"\[Lambda]", "[", 
               RowBox[{"t", "[", "i", "]"}], "]"}]}], ")"}]}], "+", 
           RowBox[{"6", 
            RowBox[{"t", "[", "i", "]"}]}], "+", 
           RowBox[{"8", 
            RowBox[{"\[Lambda]", "[", 
             RowBox[{"t", "[", "i", "]"}], "]"}]}], "-", 
           RowBox[{"9", 
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              RowBox[{"Omega", "[", 
               RowBox[{
                RowBox[{"t", "[", "i", "]"}], ",", 
                RowBox[{"t", "[", 
                 RowBox[{"i", "+", "1"}], "]"}]}], "]"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"t", "[", 
               RowBox[{"i", "+", "1"}], "]"}], "+", 
              RowBox[{"\[Lambda]", "[", 
               RowBox[{"t", "[", "i", "]"}], "]"}]}], ")"}]}]}], ")"}]}], ",",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"0", "\[LessEqual]", "i", "\[Equal]", "j", "<", "n"}], "&&", 
         
         RowBox[{"(", 
          RowBox[{
           RowBox[{"i", "\[Element]", "Integers"}], "&&", 
           RowBox[{"j", "\[Element]", "Integers"}]}], ")"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"t", "[", "n", "]"}], "+", 
         RowBox[{
          RowBox[{"\[Lambda]", "[", 
           RowBox[{"t", "[", "n", "]"}], "]"}], "/", "3"}], "+", 
         RowBox[{"\[Lambda]", "[", 
          RowBox[{"t", "[", "n", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"i", "\[Equal]", "j", "\[Equal]", "n"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"i", "\[Element]", "Integers"}], "&&", 
           RowBox[{"j", "\[Element]", "Integers"}]}], ")"}]}]}], "}"}]}], 
     "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]"}]], "Input",\

 CellChangeTimes->{{3.65859974177632*^9, 3.658599783842997*^9}, {
  3.6585999469267683`*^9, 3.658600105203744*^9}, {3.6586001682257957`*^9, 
  3.6586002204552*^9}, {3.6586002632183657`*^9, 3.6586003002394323`*^9}, {
  3.6586580396738377`*^9, 3.658658171523067*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.658658345841137*^9, 3.658658346733197*^9}}]
},
WindowSize->{1916, 498},
WindowMargins->{{0, Automatic}, {28, Automatic}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
ShowSelection->True,
FrontEndVersion->"10.0 for Linux x86 (64-bit) (December 4, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 154, 3, 32, "Input"],
Cell[714, 25, 491, 14, 32, "Input"],
Cell[CellGroupData[{
Cell[1230, 43, 443, 11, 32, "Input"],
Cell[1676, 56, 1927, 42, 250, "Output"]
}, Open  ]],
Cell[3618, 101, 427, 10, 32, "Input"],
Cell[4048, 113, 246, 6, 32, "Input"],
Cell[4297, 121, 247, 7, 32, "Input"],
Cell[4547, 130, 363, 10, 32, "Input"],
Cell[4913, 142, 118, 2, 32, "Input"],
Cell[5034, 146, 3676, 103, 212, "Input"],
Cell[8713, 251, 302, 6, 32, "Input"],
Cell[9018, 259, 164, 4, 32, "Input"],
Cell[9185, 265, 1670, 43, 60, "Input"],
Cell[10858, 310, 5785, 158, 316, "Input"],
Cell[16646, 470, 1340, 39, 84, "Input"],
Cell[17989, 511, 7437, 202, 448, "Input"],
Cell[25429, 715, 92, 1, 32, "Input"]
}
]
*)

(* End of internal cache information *)
