(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    175771,       4703]
NotebookOptionsPosition[    170354,       4539]
NotebookOutlinePosition[    170811,       4557]
CellTagsIndexPosition[    170768,       4554]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["defining model", "Section",
 CellChangeTimes->{{3.659179542879917*^9, 3.6591795438474627`*^9}, {
  3.659179594679644*^9, 3.659179595016943*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"changepoint", "=", "0.451985"}], ";"}]], "Input",
 CellChangeTimes->{{3.6585927958484917`*^9, 3.6585928054620323`*^9}, {
  3.658663697920252*^9, 3.658663699336955*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Lambda]", "[", "t_", "]"}], ":=", 
  RowBox[{"Piecewise", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"t", "<", "changepoint"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"t", "\[GreaterEqual]", "changepoint"}]}], "}"}]}], "}"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6585920831572104`*^9, 3.658592087051279*^9}, {
  3.658592941695675*^9, 3.6585929519840117`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"\[Lambda]", "[", "t", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "3"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6585915580217133`*^9, 3.6585916273123407`*^9}, {
  3.658592812890312*^9, 3.658592841933609*^9}, {3.658592956359068*^9, 
  3.658592958403122*^9}}],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
     1.], LineBox[CompressedData["
1:eJxTTMoPSmViYGCQAWIQ7ZX64uKBl6F2DGDwwb65sbuiS7LFHsZPKXkv2Sk5
Bc7nmOK58MPHJXD+9gtG7u5y6+H8iOY7tw53b4Hz8zcW6874shPO/zTh2glG
xv1w/omDx/aftzkE52dWevJGvjkC5x/kNPq/Jvc4nL9s8ZF/Uqqn4HwHsb2L
gtedgfN1j9/ZcUzrPJx/xSH43cp3F+D8HK7sS1cNLsH5p2+E7+XruwznB7tF
PHzy5Aqcb7agO3yByjU4/8G/yVcy6q/D+U89zy8WO3wDzt8w837lRcVbcP7S
DuZOzarbcL7vt3WWJ6TuwPlfk6Nepe1G8L8p3p2gfRHB/3E/3vzDMwR/m6cG
m+QLBB8A2OSaEQ==
      "]], LineBox[CompressedData["
1:eJxTTMoPSmViYGBQBWIQbfGw+lv3pzv2DBDgUPHOcYvzdwT/59xHd7f8QfB/
/VE2nM5+F8GPTm2pFELw/17Pushkh+AzhBTI9WQi+Gw+1TvmHUDwuV3agjaK
34PzXVZt1ffcheDXCDzleRhzH87n2afNcN33AZxvW+b/9/AvBH/Okp7FynMe
wvlxoSZnOb0fwflbr6ZO3vcNwbc8s4Hp2bTHcL6Ca9rXyS5P4HxTE9OJW54h
+Pc/9Z5c3PoUzn9jHNgqafQMzld7rfuK8TKCf0Sl9FJB43M4v//K1eQglRdw
/vvgAxOZjiD4m0JFnS0LX8L5i882z30k9ArO/348plroEIL/YOL+rwJ5r+H8
bxetJZv43sD5BVOUDlTuQfDFzyoJPIl7C+cHX13zR+Yfgv8pfmHOnVXv4Pz9
Cetb+Xzew/naDrG27MsQ/Ony3F///0fwAerIppU=
      "]]}, {}}, {{}, {}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{"DefaultBoundaryStyle" -> Automatic, "ScalingFunctions" -> None},
  PlotRange->{{0., 0.9999999795918367}, {0, 3}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {0, 0}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.65859158369156*^9, {3.658591616384799*^9, 3.658591628397531*^9}, {
   3.658592830565628*^9, 3.658592842628839*^9}, 3.6585929607408237`*^9, 
   3.658657284391227*^9, 3.65866371225294*^9, 3.658742049996393*^9, 
   3.6587679360725813`*^9, 3.659176724536139*^9, 3.6592691138210793`*^9, 
   3.659275924687345*^9, 3.659352826282666*^9, 3.659355908167355*^9, 
   3.6593566370801353`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ts", "=", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0.095310", ",", "0.200671", ",", "0.318454", ",", 
     "changepoint", ",", "0.606136", ",", "0.788457", ",", "1.011601", ",", 
     "1.299283", ",", "1.704748", ",", "2.397895", ",", "Infinity"}], "}"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.658592858045166*^9, 3.65859293228449*^9}, {
  3.658594097005396*^9, 3.658594098179654*^9}, {3.6587536697166967`*^9, 
  3.65875367097361*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"n", "=", 
   RowBox[{
    RowBox[{"Length", "[", "ts", "]"}], "-", "2"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6585932003793097`*^9, 3.6585932151561413`*^9}, {
  3.658594100556241*^9, 3.658594100619706*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"t", "[", "i_", "]"}], ":=", 
   RowBox[{"ts", "[", 
    RowBox[{"[", 
     RowBox[{"i", "+", "1"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.658592978244063*^9, 3.6585929889548264`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Omega", "[", 
   RowBox[{"t1_", ",", "t2_"}], "]"}], ":=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"\[Lambda]", "[", "s", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"s", ",", "t1", ",", "t2"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.658592063792857*^9, 3.658592133150588*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"io", "[", "i_", "]"}], ":=", 
  RowBox[{"Omega", "[", 
   RowBox[{
    RowBox[{"t", "[", "i", "]"}], ",", 
    RowBox[{"t", "[", 
     RowBox[{"i", "+", "1"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.658658861697729*^9, 3.6586588758107967`*^9}}],

Cell[BoxData[
 RowBox[{"(*", "Pi", "*)"}]], "Input",
 CellChangeTimes->{{3.658594776180366*^9, 3.658594778244657*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["calculating probabilities and expectations", "Section",
 CellChangeTimes->{{3.659179601080037*^9, 3.6591796095835953`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"pi", "[", 
   RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{"Piecewise", "[", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"3", "/", "2"}], "*", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "3"}], 
          RowBox[{"Omega", "[", 
           RowBox[{"0", ",", 
            RowBox[{"t", "[", "i", "]"}]}], "]"}]}], "]"}], 
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          RowBox[{"Omega", "[", 
           RowBox[{
            RowBox[{"t", "[", 
             RowBox[{"i", "+", "1"}], "]"}], ",", 
            RowBox[{"t", "[", "j", "]"}]}], "]"}]}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"-", 
            RowBox[{"Omega", "[", 
             RowBox[{
              RowBox[{"t", "[", "i", "]"}], ",", 
              RowBox[{"t", "[", 
               RowBox[{"i", "+", "1"}], "]"}]}], "]"}]}], "]"}], "-", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "3"}], 
            RowBox[{"Omega", "[", 
             RowBox[{
              RowBox[{"t", "[", "i", "]"}], ",", 
              RowBox[{"t", "[", 
               RowBox[{"i", "+", "1"}], "]"}]}], "]"}]}], "]"}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"Exp", "[", 
           RowBox[{"-", 
            RowBox[{"Omega", "[", 
             RowBox[{
              RowBox[{"t", "[", "j", "]"}], ",", 
              RowBox[{"t", "[", 
               RowBox[{"j", "+", "1"}], "]"}]}], "]"}]}], "]"}]}], ")"}]}], 
       ",", 
       RowBox[{
        RowBox[{"0", "<=", "i", "<", "j", "\[LessEqual]", "n"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"i", "\[Element]", "Integers"}], "&&", 
          RowBox[{"j", "\[Element]", "Integers"}]}], ")"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "3"}], 
          RowBox[{"Omega", "[", 
           RowBox[{"0", ",", 
            RowBox[{"t", "[", "i", "]"}]}], "]"}]}], "]"}], 
        RowBox[{"(", 
         RowBox[{"2", "-", 
          RowBox[{"3", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"t", "[", 
                 RowBox[{"i", "+", "1"}], "]"}], "-", 
                RowBox[{"t", "[", "i", "]"}]}], ")"}]}], "/", 
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"t", "[", "i", "]"}], "]"}]}], "]"}]}], "+", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "3"}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"t", "[", 
                RowBox[{"i", "+", "1"}], "]"}], "-", 
               RowBox[{"t", "[", "i", "]"}]}], ")"}], "/", 
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"t", "[", "i", "]"}], "]"}]}]}], "]"}]}], ")"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "0", "\[LessEqual]", "i", "\[Equal]", "j", "\[LessEqual]", "n"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"i", "\[Element]", "Integers"}], "&&", 
          RowBox[{"j", "\[Element]", "Integers"}]}], ")"}]}]}], "}"}]}], 
    "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.65859308266936*^9, 3.658593088363051*^9}, {
  3.658593146308301*^9, 3.6585933913786707`*^9}, {3.6585934273409348`*^9, 
  3.658593573961179*^9}, {3.658594441551848*^9, 3.65859460495435*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Pi", " ", "is", " ", "working"}], ",", " ", 
   RowBox[{"at", " ", "least", " ", "for", " ", "constant", " ", 
    RowBox[{"N", " ", "[", "\[Lambda]", "]"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.6585946563529587`*^9, 3.6585946703110533`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"E", "[", 
   RowBox[{"t_", "3"}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.658594785803606*^9, 3.65859478942553*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"intEt3", "[", 
   RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"pi", "[", 
     RowBox[{"i", ",", "j"}], "]"}]], 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      FractionBox["3", 
       RowBox[{
        RowBox[{"\[Lambda]", "[", 
         RowBox[{"t", "[", "i", "]"}], "]"}], 
        RowBox[{"\[Lambda]", "[", 
         RowBox[{"t", "[", "j", "]"}], "]"}]}]], " ", "t3", " ", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "3"}], 
        RowBox[{"Omega", "[", 
         RowBox[{"0", ",", "t3"}], "]"}]}], "]"}], 
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        RowBox[{"Omega", "[", 
         RowBox[{"t3", ",", "t2"}], "]"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"t", "[", "j", "]"}], ",", 
       RowBox[{"t", "[", 
        RowBox[{"j", "+", "1"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t3", ",", 
       RowBox[{"t", "[", "i", "]"}], ",", 
       RowBox[{"t", "[", 
        RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6585947577059937`*^9, 3.658594758625227*^9}, {
  3.658594839697444*^9, 3.658594956480558*^9}, {3.6585949971697483`*^9, 
  3.6585950053526*^9}, {3.6585951799048777`*^9, 3.658595284108556*^9}, {
  3.65859531900383*^9, 3.658595364357547*^9}, {3.6585955117255087`*^9, 
  3.658595534461152*^9}, {3.65859558054047*^9, 3.658595596316477*^9}, {
  3.658597047667261*^9, 3.658597061591826*^9}, {3.658597708584753*^9, 
  3.658597712045776*^9}, {3.658598181490839*^9, 3.658598186835086*^9}, {
  3.658598533817904*^9, 3.6585985339607687`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Et3", "[", 
   RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{"Piecewise", "[", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox["3", 
         RowBox[{"4", 
          RowBox[{"pi", "[", 
           RowBox[{"i", ",", "j"}], "]"}]}]], 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "3"}], 
          RowBox[{"Omega", "[", 
           RowBox[{"0", ",", 
            RowBox[{"t", "[", "i", "]"}]}], "]"}]}], "]"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"Exp", "[", 
           RowBox[{"-", 
            RowBox[{"Omega", "[", 
             RowBox[{
              RowBox[{"t", "[", "j", "]"}], ",", 
              RowBox[{"t", "[", 
               RowBox[{"j", "+", "1"}], "]"}]}], "]"}]}], "]"}]}], ")"}], 
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          RowBox[{"Omega", "[", 
           RowBox[{
            RowBox[{"t", "[", 
             RowBox[{"i", "+", "1"}], "]"}], ",", 
            RowBox[{"t", "[", "j", "]"}]}], "]"}]}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"t", "[", "i", "]"}], "]"}], "+", 
             RowBox[{"2", 
              RowBox[{"t", "[", "i", "]"}]}]}], ")"}], 
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             RowBox[{"Omega", "[", 
              RowBox[{
               RowBox[{"t", "[", "i", "]"}], ",", 
               RowBox[{"t", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "]"}]}], "]"}]}], "-", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"t", "[", "i", "]"}], "]"}], "+", 
             RowBox[{"2", 
              RowBox[{"t", "[", 
               RowBox[{"i", "+", "1"}], "]"}]}]}], ")"}], 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "3"}], 
             RowBox[{"Omega", "[", 
              RowBox[{
               RowBox[{"t", "[", "i", "]"}], ",", 
               RowBox[{"t", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "]"}]}], "]"}]}]}], ")"}]}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"0", "<=", "i", "<", "j", "\[LessEqual]", "n"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"i", "\[Element]", "Integers"}], "&&", 
          RowBox[{"j", "\[Element]", "Integers"}]}], ")"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox["1", 
         RowBox[{"12", 
          RowBox[{"pi", "[", 
           RowBox[{"i", ",", "i"}], "]"}]}]], 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "3"}], 
          RowBox[{"Omega", "[", 
           RowBox[{"0", ",", 
            RowBox[{"t", "[", "i", "]"}]}], "]"}]}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"3", 
              RowBox[{"t", "[", "i", "]"}]}], "+", 
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"t", "[", "i", "]"}], "]"}]}], ")"}]}], "+", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "3"}], 
             RowBox[{"Omega", "[", 
              RowBox[{
               RowBox[{"t", "[", "i", "]"}], ",", 
               RowBox[{"t", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "]"}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"6", 
              RowBox[{"t", "[", 
               RowBox[{"i", "+", "1"}], "]"}]}], "+", 
             RowBox[{"5", 
              RowBox[{"\[Lambda]", "[", 
               RowBox[{"t", "[", "i", "]"}], "]"}]}]}], ")"}]}], "-", 
          RowBox[{"9", 
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             RowBox[{"Omega", "[", 
              RowBox[{
               RowBox[{"t", "[", "i", "]"}], ",", 
               RowBox[{"t", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "]"}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", 
              RowBox[{"t", "[", "i", "]"}]}], "+", 
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"t", "[", "i", "]"}], "]"}]}], ")"}]}]}], ")"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"0", "\[LessEqual]", "i", "\[Equal]", "j", "<", "n"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"i", "\[Element]", "Integers"}], "&&", 
          RowBox[{"j", "\[Element]", "Integers"}]}], ")"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"t", "[", "i", "]"}], "+", 
        RowBox[{
         RowBox[{"\[Lambda]", "[", 
          RowBox[{"t", "[", "i", "]"}], "]"}], "/", "3.0"}]}], ",", 
       RowBox[{
        RowBox[{"i", "\[Equal]", "j", "\[Equal]", "n"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"i", "\[Element]", "Integers"}], "&&", 
          RowBox[{"j", "\[Element]", "Integers"}]}], ")"}]}]}], "}"}]}], 
    "\[IndentingNewLine]", "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.658595640078487*^9, 3.6585957604832287`*^9}, {
   3.658596980359028*^9, 3.658596988281507*^9}, {3.658598496262815*^9, 
   3.6585985043969097`*^9}, {3.658598742479361*^9, 3.658598973332593*^9}, {
   3.65859901683549*^9, 3.6585990268224373`*^9}, {3.6585990777108994`*^9, 
   3.658599088241726*^9}, {3.658599137362996*^9, 3.658599240751433*^9}, {
   3.658599272243225*^9, 3.658599272732688*^9}, 3.658599756089405*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Et2", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"intEt2", "[", 
    RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"pi", "[", 
      RowBox[{"i", ",", "j"}], "]"}]], 
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{
       FractionBox["3", 
        RowBox[{
         RowBox[{"\[Lambda]", "[", 
          RowBox[{"t", "[", "i", "]"}], "]"}], 
         RowBox[{"\[Lambda]", "[", 
          RowBox[{"t", "[", "j", "]"}], "]"}]}]], " ", "t2", " ", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", "3"}], 
         RowBox[{"Omega", "[", 
          RowBox[{"0", ",", "t3"}], "]"}]}], "]"}], 
       RowBox[{"Exp", "[", 
        RowBox[{"-", 
         RowBox[{"Omega", "[", 
          RowBox[{"t3", ",", "t2"}], "]"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"t2", ",", 
        RowBox[{"t", "[", "j", "]"}], ",", 
        RowBox[{"t", "[", 
         RowBox[{"j", "+", "1"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"t3", ",", 
        RowBox[{"t", "[", "i", "]"}], ",", 
        RowBox[{"t", "[", 
         RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6585996322019577`*^9, 3.658599647470613*^9}, {
  3.6585996860517178`*^9, 3.6585996861331472`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Et2", "[", 
   RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{"Piecewise", "[", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox["3", 
         RowBox[{"2", 
          RowBox[{"pi", "[", 
           RowBox[{"i", ",", "j"}], "]"}]}]], 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "3"}], 
          RowBox[{"Omega", "[", 
           RowBox[{"0", ",", 
            RowBox[{"t", "[", "i", "]"}]}], "]"}]}], "]"}], 
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          RowBox[{"Omega", "[", 
           RowBox[{
            RowBox[{"t", "[", 
             RowBox[{"i", "+", "1"}], "]"}], ",", 
            RowBox[{"t", "[", "j", "]"}]}], "]"}]}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"-", 
            RowBox[{"Omega", "[", 
             RowBox[{
              RowBox[{"t", "[", "i", "]"}], ",", 
              RowBox[{"t", "[", 
               RowBox[{"i", "+", "1"}], "]"}]}], "]"}]}], "]"}], "-", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "3"}], 
            RowBox[{"Omega", "[", 
             RowBox[{
              RowBox[{"t", "[", "i", "]"}], ",", 
              RowBox[{"t", "[", 
               RowBox[{"i", "+", "1"}], "]"}]}], "]"}]}], "]"}]}], ")"}], "*",
         "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Lambda]", "[", 
           RowBox[{"t", "[", "j", "]"}], "]"}], "+", 
          RowBox[{"t", "[", "j", "]"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"t", "[", "j", "]"}], "]"}], "+", 
             RowBox[{"t", "[", 
              RowBox[{"j", "+", "1"}], "]"}]}], ")"}], 
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             RowBox[{"Omega", "[", 
              RowBox[{
               RowBox[{"t", "[", "j", "]"}], ",", 
               RowBox[{"t", "[", 
                RowBox[{"j", "+", "1"}], "]"}]}], "]"}]}], "]"}]}]}], ")"}]}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"0", "\[LessEqual]", "i", "<", "j", "<", "n"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"i", "\[Element]", "Integers"}], "&&", 
          RowBox[{"j", "\[Element]", "Integers"}]}], ")"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox["3", 
         RowBox[{"2", 
          RowBox[{"pi", "[", 
           RowBox[{"i", ",", "j"}], "]"}]}]], 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "3"}], 
          RowBox[{"Omega", "[", 
           RowBox[{"0", ",", 
            RowBox[{"t", "[", "i", "]"}]}], "]"}]}], "]"}], 
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          RowBox[{"Omega", "[", 
           RowBox[{
            RowBox[{"t", "[", 
             RowBox[{"i", "+", "1"}], "]"}], ",", 
            RowBox[{"t", "[", "j", "]"}]}], "]"}]}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"-", 
            RowBox[{"Omega", "[", 
             RowBox[{
              RowBox[{"t", "[", "i", "]"}], ",", 
              RowBox[{"t", "[", 
               RowBox[{"i", "+", "1"}], "]"}]}], "]"}]}], "]"}], "-", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "3"}], 
            RowBox[{"Omega", "[", 
             RowBox[{
              RowBox[{"t", "[", "i", "]"}], ",", 
              RowBox[{"t", "[", 
               RowBox[{"i", "+", "1"}], "]"}]}], "]"}]}], "]"}]}], ")"}], "*",
         "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Lambda]", "[", 
           RowBox[{"t", "[", "j", "]"}], "]"}], "+", 
          RowBox[{"t", "[", "j", "]"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"0", "\[LessEqual]", "i", "<", "j", "==", "n"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"i", "\[Element]", "Integers"}], "&&", 
          RowBox[{"j", "\[Element]", "Integers"}]}], ")"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox["1", 
         RowBox[{"6", 
          RowBox[{"pi", "[", 
           RowBox[{"i", ",", "j"}], "]"}]}]], 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "3"}], 
          RowBox[{"Omega", "[", 
           RowBox[{"0", ",", 
            RowBox[{"t", "[", "i", "]"}]}], "]"}]}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "3"}], 
             RowBox[{"Omega", "[", 
              RowBox[{
               RowBox[{"t", "[", "i", "]"}], ",", 
               RowBox[{"t", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "]"}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"3", 
              RowBox[{"t", "[", 
               RowBox[{"i", "+", "1"}], "]"}]}], "+", 
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"t", "[", "i", "]"}], "]"}]}], ")"}]}], "+", 
          RowBox[{"6", 
           RowBox[{"t", "[", "i", "]"}]}], "+", 
          RowBox[{"8", 
           RowBox[{"\[Lambda]", "[", 
            RowBox[{"t", "[", "i", "]"}], "]"}]}], "-", 
          RowBox[{"9", 
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             RowBox[{"Omega", "[", 
              RowBox[{
               RowBox[{"t", "[", "i", "]"}], ",", 
               RowBox[{"t", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "]"}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"t", "[", 
              RowBox[{"i", "+", "1"}], "]"}], "+", 
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"t", "[", "i", "]"}], "]"}]}], ")"}]}]}], ")"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"0", "\[LessEqual]", "i", "\[Equal]", "j", "<", "n"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"i", "\[Element]", "Integers"}], "&&", 
          RowBox[{"j", "\[Element]", "Integers"}]}], ")"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"t", "[", "n", "]"}], "+", 
        RowBox[{
         RowBox[{"\[Lambda]", "[", 
          RowBox[{"t", "[", "n", "]"}], "]"}], "/", "3"}], "+", 
        RowBox[{"\[Lambda]", "[", 
         RowBox[{"t", "[", "n", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"i", "\[Equal]", "j", "\[Equal]", "n"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"i", "\[Element]", "Integers"}], "&&", 
          RowBox[{"j", "\[Element]", "Integers"}]}], ")"}]}]}], "}"}]}], 
    "\[IndentingNewLine]", "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.65859974177632*^9, 3.658599783842997*^9}, {
   3.6585999469267683`*^9, 3.658600105203744*^9}, {3.6586001682257957`*^9, 
   3.6586002204552*^9}, {3.6586002632183657`*^9, 3.6586003002394323`*^9}, {
   3.6586580396738377`*^9, 3.658658171523067*^9}, 3.658765798378242*^9, 
   3.6593538903756647`*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["calculating transitions", "Section",
 CellChangeTimes->{{3.659179616351492*^9, 3.65917961810406*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"intqts", "[", 
   RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
  RowBox[{"Piecewise", "[", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"(*", 
       RowBox[{"case", " ", "A"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Assuming", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"s3", ",", "s2", ",", "t2", ",", "t3", ",", "u"}], "}"}], 
          "\[Element]", "Reals"}], ",", 
         RowBox[{
          RowBox[{"Integrate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                FractionBox["1", 
                 RowBox[{
                  RowBox[{"2", "s2"}], "+", "s3"}]], 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "3"}], 
                  RowBox[{"Omega", "[", 
                   RowBox[{"u", ",", "s3"}], "]"}]}], "]"}], 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "2"}], 
                  RowBox[{"Omega", "[", 
                   RowBox[{"s3", ",", "s2"}], "]"}]}], "]"}], "*", 
                FractionBox["1", 
                 RowBox[{"\[Lambda]", "[", "t2", "]"}]], 
                RowBox[{"Exp", "[", 
                 RowBox[{"-", 
                  RowBox[{"Omega", "[", 
                   RowBox[{"s2", ",", "t2"}], "]"}]}], "]"}]}], ")"}], "*", 
              RowBox[{"DiracDelta", "[", 
               RowBox[{"t3", "-", 
                RowBox[{"Et3", "[", 
                 RowBox[{"i", ",", "j"}], "]"}]}], "]"}]}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"s3", "\[Rule]", 
                RowBox[{"Et3", "[", 
                 RowBox[{"i", ",", "j"}], "]"}]}], ",", 
               RowBox[{"s2", "\[Rule]", 
                RowBox[{"Et2", "[", 
                 RowBox[{"i", ",", "j"}], "]"}]}]}], "}"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"u", ",", "0", ",", 
              RowBox[{"Et3", "[", 
               RowBox[{"i", ",", "j"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"t2", ",", 
              RowBox[{"t", "[", "l", "]"}], ",", 
              RowBox[{"t", "[", 
               RowBox[{"l", "+", "1"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"t3", ",", 
              RowBox[{"t", "[", "k", "]"}], ",", 
              RowBox[{"t", "[", 
               RowBox[{"k", "+", "1"}], "]"}]}], "}"}]}], "]"}], "+", 
          RowBox[{"Integrate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                FractionBox["2", 
                 RowBox[{
                  RowBox[{"2", "s2"}], "+", "s3"}]], 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "2"}], 
                  RowBox[{"Omega", "[", 
                   RowBox[{"u", ",", "s2"}], "]"}]}], "]"}], "*", 
                FractionBox["1", 
                 RowBox[{"\[Lambda]", "[", "t2", "]"}]], 
                RowBox[{"Exp", "[", 
                 RowBox[{"-", 
                  RowBox[{"Omega", "[", 
                   RowBox[{"s2", ",", "t2"}], "]"}]}], "]"}]}], ")"}], "*", 
              RowBox[{"DiracDelta", "[", 
               RowBox[{"t3", "-", 
                RowBox[{"Et3", "[", 
                 RowBox[{"i", ",", "j"}], "]"}]}], "]"}]}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"s3", "\[Rule]", 
                RowBox[{"Et3", "[", 
                 RowBox[{"i", ",", "j"}], "]"}]}], ",", 
               RowBox[{"s2", "\[Rule]", 
                RowBox[{"Et2", "[", 
                 RowBox[{"i", ",", "j"}], "]"}]}]}], "}"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"u", ",", 
              RowBox[{"Et3", "[", 
               RowBox[{"i", ",", "j"}], "]"}], ",", 
              RowBox[{"Et2", "[", 
               RowBox[{"i", ",", "j"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"t2", ",", 
              RowBox[{"t", "[", "l", "]"}], ",", 
              RowBox[{"t", "[", 
               RowBox[{"l", "+", "1"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"t3", ",", 
              RowBox[{"t", "[", "k", "]"}], ",", 
              RowBox[{"t", "[", 
               RowBox[{"k", "+", "1"}], "]"}]}], "}"}]}], "]"}]}]}], "]"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "0", "\[LessEqual]", "i", "\[Equal]", "k", "<", "j", "<", "l"}], "&&", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "}"}], "\[Element]", 
         "Integers"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"(*", 
       RowBox[{"case", " ", "B"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Assuming", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"s3", ",", "s2", ",", "t2", ",", "t3", ",", "u"}], "}"}], 
          "\[Element]", "Reals"}], ",", 
         RowBox[{
          RowBox[{"NIntegrate", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              FractionBox["1", 
               RowBox[{
                RowBox[{"2", 
                 RowBox[{"Et2", "[", 
                  RowBox[{"i", ",", "j"}], "]"}]}], "+", 
                RowBox[{"Et3", "[", 
                 RowBox[{"i", ",", "j"}], "]"}]}]], 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "3"}], 
                RowBox[{"Omega", "[", 
                 RowBox[{"u", ",", 
                  RowBox[{"Et3", "[", 
                   RowBox[{"i", ",", "j"}], "]"}]}], "]"}]}], "]"}], 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "2"}], 
                RowBox[{"Omega", "[", 
                 RowBox[{
                  RowBox[{"Et3", "[", 
                   RowBox[{"i", ",", "j"}], "]"}], ",", "t2"}], "]"}]}], 
               "]"}], "*", 
              FractionBox["1", 
               RowBox[{"\[Lambda]", "[", "t2", "]"}]]}], ")"}], ",", 
            RowBox[{"{", 
             RowBox[{"u", ",", "0", ",", 
              RowBox[{"Et3", "[", 
               RowBox[{"i", ",", "j"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"t2", ",", 
              RowBox[{"t", "[", "l", "]"}], ",", 
              RowBox[{"t", "[", 
               RowBox[{"l", "+", "1"}], "]"}]}], "}"}]}], "]"}], "+", 
          "\[IndentingNewLine]", 
          RowBox[{"NIntegrate", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              FractionBox["2", 
               RowBox[{
                RowBox[{"2", 
                 RowBox[{"Et2", "[", 
                  RowBox[{"i", ",", "j"}], "]"}]}], "+", 
                RowBox[{"Et3", "[", 
                 RowBox[{"i", ",", "j"}], "]"}]}]], 
              FractionBox["1", 
               RowBox[{"\[Lambda]", "[", "t2", "]"}]], 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "2"}], 
                RowBox[{"Omega", "[", 
                 RowBox[{"u", ",", "t2"}], "]"}]}], "]"}]}], ")"}], ",", 
            RowBox[{"{", 
             RowBox[{"t2", ",", 
              RowBox[{"t", "[", "l", "]"}], ",", 
              RowBox[{"t", "[", 
               RowBox[{"l", "+", "1"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"u", ",", 
              RowBox[{"Et3", "[", 
               RowBox[{"i", ",", "j"}], "]"}], ",", "t2"}], "}"}]}], 
           "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "0", "\[LessEqual]", "i", "\[Equal]", "k", "<", "l", "<", "j"}], "&&", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "}"}], "\[Element]", 
         "Integers"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"case", " ", "C"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Assuming", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"s3", ",", "s2", ",", "t2", ",", "t3", ",", "u"}], "}"}], 
          "\[Element]", "Reals"}], ",", 
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             FractionBox["1", 
              RowBox[{
               RowBox[{"2", 
                RowBox[{"Et2", "[", 
                 RowBox[{"i", ",", "j"}], "]"}]}], "+", 
               RowBox[{"Et3", "[", 
                RowBox[{"i", ",", "j"}], "]"}]}]], "*", 
             FractionBox["2", 
              RowBox[{"\[Lambda]", "[", "t3", "]"}]], "*", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "3"}], 
               RowBox[{"Omega", "[", 
                RowBox[{"u", ",", "t3"}], "]"}]}], "]"}]}], ")"}], ",", 
           RowBox[{"{", 
            RowBox[{"t3", ",", 
             RowBox[{"t", "[", "k", "]"}], ",", 
             RowBox[{"t", "[", 
              RowBox[{"k", "+", "1"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"u", ",", "0", ",", "t3"}], "}"}]}], "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "0", "\[LessEqual]", "k", "<", "i", "\[Equal]", "l", "<", "j"}], "&&", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "}"}], "\[Element]", 
         "Integers"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"case", " ", "D"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Assuming", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"s3", ",", "s2", ",", "t2", ",", "t3", ",", "u"}], "}"}], 
          "\[Element]", "Reals"}], ",", 
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             FractionBox["2", 
              RowBox[{
               RowBox[{"2", 
                RowBox[{"Et2", "[", 
                 RowBox[{"i", ",", "j"}], "]"}]}], "+", 
               RowBox[{"Et3", "[", 
                RowBox[{"i", ",", "j"}], "]"}]}]], "*", 
             FractionBox["2", 
              RowBox[{"\[Lambda]", "[", "t3", "]"}]], "*", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "3"}], 
               RowBox[{"Omega", "[", 
                RowBox[{"u", ",", "t3"}], "]"}]}], "]"}]}], ")"}], ",", 
           RowBox[{"{", 
            RowBox[{"t3", ",", 
             RowBox[{"t", "[", "k", "]"}], ",", 
             RowBox[{"t", "[", 
              RowBox[{"k", "+", "1"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"u", ",", "0", ",", "t3"}], "}"}]}], "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "0", "\[LessEqual]", "k", "<", "i", "<", "j", "\[Equal]", "l"}], "&&", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "}"}], "\[Element]", 
         "Integers"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"case", " ", "E"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Assuming", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"s3", ",", "s2", ",", "t2", ",", "t3", ",", "u"}], "}"}], 
          "\[Element]", "Reals"}], ",", 
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             FractionBox["2", 
              RowBox[{
               RowBox[{"2", 
                RowBox[{"Et2", "[", 
                 RowBox[{"i", ",", "j"}], "]"}]}], "+", 
               RowBox[{"Et3", "[", 
                RowBox[{"i", ",", "j"}], "]"}]}]], "*", 
             FractionBox["2", 
              RowBox[{"\[Lambda]", "[", "t3", "]"}]], "*", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "3"}], 
               RowBox[{"Omega", "[", 
                RowBox[{"u", ",", 
                 RowBox[{"Et3", "[", 
                  RowBox[{"i", ",", "j"}], "]"}]}], "]"}]}], "]"}], 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "2"}], 
               RowBox[{"Omega", "[", 
                RowBox[{
                 RowBox[{"Et3", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], ",", "t3"}], "]"}]}], 
              "]"}]}], ")"}], ",", 
           RowBox[{"{", 
            RowBox[{"t3", ",", 
             RowBox[{"t", "[", "k", "]"}], ",", 
             RowBox[{"t", "[", 
              RowBox[{"k", "+", "1"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"u", ",", "0", ",", 
             RowBox[{"Et3", "[", 
              RowBox[{"i", ",", "j"}], "]"}]}], "}"}]}], "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "0", "\[LessEqual]", "i", "<", "k", "<", "j", "\[Equal]", "l"}], "&&", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "}"}], "\[Element]", 
         "Integers"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"case", " ", "F"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Assuming", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"s3", ",", "s2", ",", "t2", ",", "t3", ",", "u"}], "}"}], 
          "\[Element]", "Reals"}], ",", 
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             FractionBox["2", 
              RowBox[{
               RowBox[{"2", 
                RowBox[{"Et2", "[", 
                 RowBox[{"i", ",", "j"}], "]"}]}], "+", 
               RowBox[{"Et3", "[", 
                RowBox[{"i", ",", "j"}], "]"}]}]], "*", 
             FractionBox["1", 
              RowBox[{"\[Lambda]", "[", "t2", "]"}]], 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "3"}], 
               RowBox[{"Omega", "[", 
                RowBox[{"u", ",", 
                 RowBox[{"Et3", "[", 
                  RowBox[{"i", ",", "j"}], "]"}]}], "]"}]}], "]"}], 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "2"}], 
               RowBox[{"Omega", "[", 
                RowBox[{
                 RowBox[{"Et3", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], ",", 
                 RowBox[{"Et2", "[", 
                  RowBox[{"i", ",", "j"}], "]"}]}], "]"}]}], "]"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{"Omega", "[", 
                RowBox[{
                 RowBox[{"Et2", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], ",", "t2"}], "]"}]}], 
              "]"}]}], ")"}], ",", 
           RowBox[{"{", 
            RowBox[{"t2", ",", 
             RowBox[{"t", "[", "l", "]"}], ",", 
             RowBox[{"t", "[", 
              RowBox[{"l", "+", "1"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"u", ",", "0", ",", 
             RowBox[{"Et3", "[", 
              RowBox[{"i", ",", "j"}], "]"}]}], "}"}]}], "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "0", "\[LessEqual]", "i", "<", "j", "\[Equal]", "k", "<", "l"}], "&&", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "}"}], "\[Element]", 
         "Integers"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"case", " ", "G", " ", "and", " ", "G2"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Assuming", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"s3", ",", "s2", ",", "t2", ",", "t3", ",", "u"}], "}"}], 
           "\[Element]", "Reals"}], ",", 
          RowBox[{"NIntegrate", "[", 
           RowBox[{
            RowBox[{
             FractionBox["1", 
              RowBox[{
               RowBox[{"2", 
                RowBox[{"Et2", "[", 
                 RowBox[{"i", ",", "j"}], "]"}]}], "+", 
               RowBox[{"Et3", "[", 
                RowBox[{"i", ",", "j"}], "]"}]}]], "*", 
             FractionBox["1", 
              RowBox[{"\[Lambda]", "[", "t2", "]"}]], 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "3"}], 
               RowBox[{"Omega", "[", 
                RowBox[{"u", ",", 
                 RowBox[{"Et3", "[", 
                  RowBox[{"i", ",", "j"}], "]"}]}], "]"}]}], "]"}], 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "2"}], 
               RowBox[{"Omega", "[", 
                RowBox[{
                 RowBox[{"Et3", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], ",", "t2"}], "]"}]}], 
              "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"t2", ",", 
              RowBox[{"Et3", "[", 
               RowBox[{"i", ",", "j"}], "]"}], ",", 
              RowBox[{"t", "[", 
               RowBox[{"l", "+", "1"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"u", ",", "0", ",", 
              RowBox[{"Et3", "[", 
               RowBox[{"i", ",", "j"}], "]"}]}], "}"}]}], "]"}]}], "]"}], "+",
         "\[IndentingNewLine]", 
        RowBox[{"Assuming", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"s3", ",", "s2", ",", "t2", ",", "t3", ",", "u"}], "}"}], 
           "\[Element]", "Reals"}], ",", 
          RowBox[{"NIntegrate", "[", 
           RowBox[{
            RowBox[{
             FractionBox["2", 
              RowBox[{
               RowBox[{"2", 
                RowBox[{"Et2", "[", 
                 RowBox[{"i", ",", "j"}], "]"}]}], "+", 
               RowBox[{"Et3", "[", 
                RowBox[{"i", ",", "j"}], "]"}]}]], "*", 
             FractionBox["1", 
              RowBox[{"\[Lambda]", "[", "t2", "]"}]], 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "2"}], 
               RowBox[{"Omega", "[", 
                RowBox[{"u", ",", "t2"}], "]"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"t2", ",", 
              RowBox[{"Et3", "[", 
               RowBox[{"i", ",", "j"}], "]"}], ",", 
              RowBox[{"t", "[", 
               RowBox[{"l", "+", "1"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"u", ",", 
              RowBox[{"Et3", "[", 
               RowBox[{"i", ",", "j"}], "]"}], ",", "t2"}], "}"}]}], "]"}]}], 
         "]"}], "+", "\[IndentingNewLine]", 
        RowBox[{"Assuming", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"s3", ",", "s2", ",", "t2", ",", "t3", ",", "u"}], "}"}], 
           "\[Element]", "Reals"}], ",", 
          RowBox[{"NIntegrate", "[", 
           RowBox[{
            RowBox[{
             FractionBox["1", 
              RowBox[{
               RowBox[{"2", 
                RowBox[{"Et2", "[", 
                 RowBox[{"i", ",", "j"}], "]"}]}], "+", 
               RowBox[{"Et3", "[", 
                RowBox[{"i", ",", "j"}], "]"}]}]], "*", 
             FractionBox["2", 
              RowBox[{"\[Lambda]", "[", "t3", "]"}]], 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "3"}], 
               RowBox[{"Omega", "[", 
                RowBox[{"u", ",", "t3"}], "]"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"t3", ",", 
              RowBox[{"t", "[", "k", "]"}], ",", 
              RowBox[{"Et3", "[", 
               RowBox[{"i", ",", "j"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"u", ",", "0", ",", "t3"}], "}"}]}], "]"}]}], "]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "0", "\[LessEqual]", "i", "\[Equal]", "k", "\[Equal]", "l", "<", "j", 
         "\[LessEqual]", "n"}], "&&", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "}"}], "\[Element]", 
         "Integers"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"case", " ", "H", " ", "and", " ", "H2"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Assuming", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"s3", ",", "s2", ",", "t2", ",", "t3", ",", "u"}], "}"}], 
           "\[Element]", "Reals"}], ",", 
          RowBox[{"NIntegrate", "[", 
           RowBox[{
            RowBox[{
             FractionBox["2", 
              RowBox[{
               RowBox[{"2", 
                RowBox[{"Et2", "[", 
                 RowBox[{"i", ",", "j"}], "]"}]}], "+", 
               RowBox[{"Et3", "[", 
                RowBox[{"i", ",", "j"}], "]"}]}]], "*", 
             FractionBox["2", 
              RowBox[{"\[Lambda]", "[", "t3", "]"}]], 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "3"}], 
               RowBox[{"Omega", "[", 
                RowBox[{"u", ",", 
                 RowBox[{"Et3", "[", 
                  RowBox[{"i", ",", "j"}], "]"}]}], "]"}]}], "]"}], 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "2"}], 
               RowBox[{"Omega", "[", 
                RowBox[{
                 RowBox[{"Et3", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], ",", "t3"}], "]"}]}], 
              "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"t3", ",", 
              RowBox[{"t", "[", "k", "]"}], ",", 
              RowBox[{"Et2", "[", 
               RowBox[{"i", ",", "j"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"u", ",", "0", ",", 
              RowBox[{"Et3", "[", 
               RowBox[{"i", ",", "j"}], "]"}]}], "}"}]}], "]"}]}], "]"}], "+",
         "\[IndentingNewLine]", 
        RowBox[{"Assuming", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"s3", ",", "s2", ",", "t2", ",", "t3", ",", "u"}], "}"}], 
           "\[Element]", "Reals"}], ",", 
          RowBox[{"NIntegrate", "[", 
           RowBox[{
            RowBox[{
             FractionBox["2", 
              RowBox[{
               RowBox[{"2", 
                RowBox[{"Et2", "[", 
                 RowBox[{"i", ",", "j"}], "]"}]}], "+", 
               RowBox[{"Et3", "[", 
                RowBox[{"i", ",", "j"}], "]"}]}]], "*", 
             FractionBox["1", 
              RowBox[{"\[Lambda]", "[", "t2", "]"}]], 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "3"}], 
               RowBox[{"Omega", "[", 
                RowBox[{"u", ",", 
                 RowBox[{"Et3", "[", 
                  RowBox[{"i", ",", "j"}], "]"}]}], "]"}]}], "]"}], 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "2"}], 
               RowBox[{"Omega", "[", 
                RowBox[{
                 RowBox[{"Et3", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], ",", 
                 RowBox[{"Et2", "[", 
                  RowBox[{"i", ",", "j"}], "]"}]}], "]"}]}], "]"}], "*", 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{"Omega", "[", 
                RowBox[{
                 RowBox[{"Et2", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], ",", "t2"}], "]"}]}], 
              "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"t2", ",", 
              RowBox[{"Et2", "[", 
               RowBox[{"i", ",", "j"}], "]"}], ",", 
              RowBox[{"t", "[", 
               RowBox[{"k", "+", "1"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"u", ",", "0", ",", 
              RowBox[{"Et3", "[", 
               RowBox[{"i", ",", "j"}], "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "0", "\[LessEqual]", "i", "<", "k", "\[Equal]", "l", "\[Equal]", "j", 
         "\[LessEqual]", "n"}], "&&", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "}"}], "\[Element]", 
         "Integers"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"case", " ", "I", " ", "and", " ", "I2"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Assuming", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"s3", ",", "s2", ",", "t2", ",", "t3", ",", "u"}], "}"}], 
           "\[Element]", "Reals"}], ",", 
          RowBox[{"NIntegrate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "3"}], " ", 
                 RowBox[{"Omega", "[", 
                  RowBox[{"u", ",", 
                   RowBox[{"Et3", "[", 
                    RowBox[{"i", ",", "j"}], "]"}]}], "]"}]}], "]"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "2"}], " ", 
                 RowBox[{"Omega", "[", 
                  RowBox[{
                   RowBox[{"Et3", "[", 
                    RowBox[{"i", ",", "j"}], "]"}], ",", 
                   RowBox[{"Et2", "[", 
                    RowBox[{"i", ",", "j"}], "]"}]}], "]"}]}], "]"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"-", 
                 RowBox[{"Omega", "[", 
                  RowBox[{
                   RowBox[{"Et2", "[", 
                    RowBox[{"i", ",", "j"}], "]"}], ",", "t2"}], "]"}]}], 
                "]"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", 
                  RowBox[{"Et2", "[", 
                   RowBox[{"i", ",", "j"}], "]"}]}], "+", 
                 RowBox[{"Et3", "[", 
                  RowBox[{"i", ",", "j"}], "]"}]}], ")"}], " ", 
               RowBox[{"\[Lambda]", "[", "t2", "]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"t2", ",", 
              RowBox[{"t", "[", "l", "]"}], ",", 
              RowBox[{"t", "[", 
               RowBox[{"l", "+", "1"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"u", ",", "0", ",", 
              RowBox[{"Et3", "[", 
               RowBox[{"i", ",", "j"}], "]"}]}], "}"}]}], "]"}]}], "]"}], "+", 
        RowBox[{"Assuming", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"s3", ",", "s2", ",", "t2", ",", "t3", ",", "u"}], "}"}], 
           "\[Element]", "Reals"}], ",", 
          RowBox[{"NIntegrate", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"2", " ", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "2"}], " ", 
                RowBox[{"Omega", "[", 
                 RowBox[{"u", ",", 
                  RowBox[{"Et2", "[", 
                   RowBox[{"i", ",", "j"}], "]"}]}], "]"}]}], "]"}], " ", 
              RowBox[{"Exp", "[", 
               RowBox[{"-", 
                RowBox[{"Omega", "[", 
                 RowBox[{
                  RowBox[{"Et2", "[", 
                   RowBox[{"i", ",", "j"}], "]"}], ",", "t2"}], "]"}]}], 
               "]"}]}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", 
                 RowBox[{"Et2", "[", 
                  RowBox[{"i", ",", "j"}], "]"}]}], "+", 
                RowBox[{"Et3", "[", 
                 RowBox[{"i", ",", "j"}], "]"}]}], ")"}], " ", 
              RowBox[{"\[Lambda]", "[", "t2", "]"}]}]], ",", 
            RowBox[{"{", 
             RowBox[{"t2", ",", 
              RowBox[{"t", "[", "l", "]"}], ",", 
              RowBox[{"t", "[", 
               RowBox[{"l", "+", "1"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"u", ",", 
              RowBox[{"Et3", "[", 
               RowBox[{"i", ",", "j"}], "]"}], ",", 
              RowBox[{"Et2", "[", 
               RowBox[{"i", ",", "j"}], "]"}]}], "}"}]}], "]"}]}], "]"}], "+",
         "\[IndentingNewLine]", 
        RowBox[{"Assuming", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"s3", ",", "s2", ",", "t2", ",", "t3", ",", "u"}], "}"}], 
           "\[Element]", "Reals"}], ",", 
          RowBox[{"NIntegrate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "3"}], " ", 
                 RowBox[{"Omega", "[", 
                  RowBox[{"u", ",", 
                   RowBox[{"Et3", "[", 
                    RowBox[{"i", ",", "j"}], "]"}]}], "]"}]}], "]"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "2"}], " ", 
                 RowBox[{"Omega", "[", 
                  RowBox[{
                   RowBox[{"Et3", "[", 
                    RowBox[{"i", ",", "j"}], "]"}], ",", 
                   RowBox[{"Et2", "[", 
                    RowBox[{"i", ",", "j"}], "]"}]}], "]"}]}], "]"}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"-", 
                 RowBox[{"Omega", "[", 
                  RowBox[{
                   RowBox[{"Et2", "[", 
                    RowBox[{"i", ",", "j"}], "]"}], ",", "t2"}], "]"}]}], 
                "]"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", 
                  RowBox[{"Et2", "[", 
                   RowBox[{"i", ",", "j"}], "]"}]}], "+", 
                 RowBox[{"Et3", "[", 
                  RowBox[{"i", ",", "j"}], "]"}]}], ")"}], " ", 
               RowBox[{"\[Lambda]", "[", "t2", "]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"t2", ",", 
              RowBox[{"t", "[", "l", "]"}], ",", 
              RowBox[{"t", "[", 
               RowBox[{"l", "+", "1"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"u", ",", "0", ",", 
              RowBox[{"Et3", "[", 
               RowBox[{"i", ",", "j"}], "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "0", "\[LessEqual]", "i", "\[Equal]", "j", "\[Equal]", "k", "<", 
         "l"}], "&&", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "}"}], "\[Element]", 
         "Integers"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"case", " ", "J", " ", "and", " ", "J2"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Assuming", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"s3", ",", "s2", ",", "t2", ",", "t3", ",", "u"}], "}"}], 
           "\[Element]", "Reals"}], ",", 
          RowBox[{"NIntegrate", "[", 
           RowBox[{
            RowBox[{
             FractionBox["2", 
              RowBox[{
               RowBox[{"2", 
                RowBox[{"Et2", "[", 
                 RowBox[{"i", ",", "j"}], "]"}]}], "+", 
               RowBox[{"Et3", "[", 
                RowBox[{"i", ",", "j"}], "]"}]}]], "*", 
             FractionBox["2", 
              RowBox[{"\[Lambda]", "[", "t3", "]"}]], 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "3"}], 
               RowBox[{"Omega", "[", 
                RowBox[{"u", ",", "t3"}], "]"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"t3", ",", 
              RowBox[{"t", "[", "k", "]"}], ",", 
              RowBox[{"t", "[", 
               RowBox[{"k", "+", "1"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"u", ",", "0", ",", "t3"}], "}"}]}], "]"}]}], "]"}], "+",
         "\[IndentingNewLine]", 
        RowBox[{"Assuming", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"s3", ",", "s2", ",", "t2", ",", "t3", ",", "u"}], "}"}], 
           "\[Element]", "Reals"}], ",", 
          RowBox[{"NIntegrate", "[", 
           RowBox[{
            RowBox[{
             FractionBox["2", 
              RowBox[{
               RowBox[{"2", 
                RowBox[{"Et2", "[", 
                 RowBox[{"i", ",", "j"}], "]"}]}], "+", 
               RowBox[{"Et3", "[", 
                RowBox[{"i", ",", "j"}], "]"}]}]], "*", 
             FractionBox["1", 
              RowBox[{"\[Lambda]", "[", "t3", "]"}]], 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "3"}], 
               RowBox[{"Omega", "[", 
                RowBox[{"u", ",", "t3"}], "]"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"t3", ",", 
              RowBox[{"t", "[", "k", "]"}], ",", 
              RowBox[{"t", "[", 
               RowBox[{"k", "+", "1"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"u", ",", "0", ",", "t3"}], "}"}]}], "]"}]}], "]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "0", "\[LessEqual]", "k", "<", "i", "\[Equal]", "j", "\[Equal]", 
         "l"}], "&&", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "}"}], "\[Element]", 
         "Integers"}]}]}], "\[IndentingNewLine]", "}"}]}], 
    "\[IndentingNewLine]", "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.658663321435339*^9, 3.658663339440797*^9}, {
   3.658663447778816*^9, 3.6586635411553907`*^9}, {3.658663582656753*^9, 
   3.658663617676425*^9}, {3.6586638020334473`*^9, 3.658663892559763*^9}, {
   3.658663978596451*^9, 3.6586639791322603`*^9}, {3.6586640124701366`*^9, 
   3.6586640307068157`*^9}, {3.65866430149891*^9, 3.658664302032331*^9}, {
   3.6586643346711607`*^9, 3.6586644191741343`*^9}, {3.658665388806382*^9, 
   3.658665443435356*^9}, {3.65866548441068*^9, 3.6586656727825317`*^9}, {
   3.658665750465785*^9, 3.658665757764497*^9}, 3.658665967016561*^9, {
   3.6586660827386713`*^9, 3.6586661202156067`*^9}, {3.6586661595801487`*^9, 
   3.658666171325424*^9}, {3.658666219894685*^9, 3.658666401112679*^9}, {
   3.658666471168746*^9, 3.6586664739710283`*^9}, 3.658666666849773*^9, 
   3.658667147287455*^9, {3.658667203411228*^9, 3.658667212813916*^9}, {
   3.6586672686047783`*^9, 3.6586672785178413`*^9}, {3.658667326592038*^9, 
   3.6586673476391363`*^9}, 3.658667385743977*^9, {3.658667420005269*^9, 
   3.658667424933153*^9}, {3.6586696606505632`*^9, 3.6586697797926702`*^9}, {
   3.6586698127933292`*^9, 3.6586698300826883`*^9}, {3.658669866089705*^9, 
   3.658669881494211*^9}, {3.658669911833197*^9, 3.658669917801811*^9}, {
   3.658670212962461*^9, 3.658670258886732*^9}, {3.658670470172626*^9, 
   3.658670565440509*^9}, {3.658670721496441*^9, 3.6586707312399797`*^9}, {
   3.658671049882307*^9, 3.658671056189341*^9}, {3.658671099099246*^9, 
   3.6586712083156357`*^9}, {3.6586754324439096`*^9, 3.658675466423411*^9}, {
   3.658675529723822*^9, 3.6586755985556297`*^9}, {3.658675873397016*^9, 
   3.658675884927917*^9}, {3.658675942209466*^9, 3.658676042129944*^9}, {
   3.658676558079444*^9, 3.6586766210803823`*^9}, {3.658676657554347*^9, 
   3.658676665637763*^9}, {3.6586797524077597`*^9, 3.65867975893375*^9}, {
   3.6586798264463263`*^9, 3.658679845925934*^9}, {3.658679910022078*^9, 
   3.658680045089319*^9}, {3.65868025211017*^9, 3.6586803134414167`*^9}, {
   3.658701406710061*^9, 3.6587014270137873`*^9}, {3.6587420673891153`*^9, 
   3.658742074653961*^9}, {3.658746202785117*^9, 3.658746449971135*^9}, {
   3.658746492015506*^9, 3.6587467074474373`*^9}, 3.6587468459261007`*^9, {
   3.6587470242351103`*^9, 3.65874703654314*^9}, {3.6587471143816433`*^9, 
   3.658747190861712*^9}, {3.658747563816184*^9, 3.6587475771892357`*^9}, {
   3.658751383950485*^9, 3.658751384279633*^9}, {3.6587566236539392`*^9, 
   3.658756697463376*^9}, {3.658756745758047*^9, 3.658756804729299*^9}, {
   3.65875686210483*^9, 3.658756862191554*^9}, {3.658756894597658*^9, 
   3.658756921947794*^9}, {3.658757659802314*^9, 3.658757659855365*^9}, {
   3.6587577022863083`*^9, 3.658757748077593*^9}, {3.658758452323721*^9, 
   3.658758454625143*^9}, {3.658758500921204*^9, 3.658758551715057*^9}, {
   3.658760395357685*^9, 3.658760402059923*^9}, 3.658760460990049*^9, 
   3.658760574907755*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"qts", "[", 
   RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
  RowBox[{"Piecewise", "[", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"(*", " ", 
       RowBox[{"case", " ", "A"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         FractionBox["1", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"Et2", "[", 
             RowBox[{"i", ",", "j"}], "]"}]}], "+", 
           RowBox[{"Et3", "[", 
            RowBox[{"i", ",", "j"}], "]"}]}]], 
         RowBox[{
          FractionBox["1", 
           RowBox[{"\[Lambda]", "[", 
            RowBox[{"t", "[", "l", "]"}], "]"}]], 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "2"}], 
            RowBox[{"Omega", "[", 
             RowBox[{
              RowBox[{"Et3", "[", 
               RowBox[{"i", ",", "j"}], "]"}], ",", 
              RowBox[{"Et2", "[", 
               RowBox[{"i", ",", "j"}], "]"}]}], "]"}]}], "]"}]}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "3"}], 
                RowBox[{"Omega", "[", 
                 RowBox[{
                  RowBox[{"t", "[", 
                   RowBox[{"a", "+", "1"}], "]"}], ",", 
                  RowBox[{"Et3", "[", 
                   RowBox[{"i", ",", "j"}], "]"}]}], "]"}]}], "]"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "3"}], 
                  RowBox[{"io", "[", "a", "]"}]}], "]"}]}], ")"}], 
              FractionBox[
               RowBox[{"\[Lambda]", "[", 
                RowBox[{"t", "[", "a", "]"}], "]"}], "3"]}], ",", 
             RowBox[{"{", 
              RowBox[{"a", ",", "0", ",", 
               RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "3"}], 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Et3", "[", 
                    RowBox[{"i", ",", "j"}], "]"}], "-", 
                   RowBox[{"t", "[", "i", "]"}]}], ")"}], "/", 
                 RowBox[{"\[Lambda]", "[", 
                  RowBox[{"t", "[", "i", "]"}], "]"}]}]}], "]"}]}], ")"}], 
            "*", 
            FractionBox[
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"t", "[", "i", "]"}], "]"}], "3"]}]}], ")"}], "*", 
         "\[IndentingNewLine]", 
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           RowBox[{"Omega", "[", 
            RowBox[{
             RowBox[{"Et2", "[", 
              RowBox[{"i", ",", "j"}], "]"}], ",", 
             RowBox[{"t", "[", "l", "]"}]}], "]"}]}], "]"}], 
         RowBox[{"\[Lambda]", "[", 
          RowBox[{"t", "[", "l", "]"}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             RowBox[{"io", "[", "l", "]"}]}], "]"}]}], ")"}]}], "+", 
        "\[IndentingNewLine]", 
        RowBox[{
         FractionBox["2", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"Et2", "[", 
             RowBox[{"i", ",", "j"}], "]"}]}], "+", 
           RowBox[{"Et3", "[", 
            RowBox[{"i", ",", "j"}], "]"}]}]], "*", 
         FractionBox["1", 
          RowBox[{"\[Lambda]", "[", 
           RowBox[{"t", "[", "l", "]"}], "]"}]], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "2"}], 
              RowBox[{"Omega", "[", 
               RowBox[{
                RowBox[{"t", "[", 
                 RowBox[{"i", "+", "1"}], "]"}], ",", 
                RowBox[{"Et2", "[", 
                 RowBox[{"i", ",", "j"}], "]"}]}], "]"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "2"}], 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"t", "[", 
                    RowBox[{"i", "+", "1"}], "]"}], "-", 
                   RowBox[{"Et3", "[", 
                    RowBox[{"i", ",", "j"}], "]"}]}], ")"}], "/", 
                 RowBox[{"\[Lambda]", "[", 
                  RowBox[{"t", "[", "i", "]"}], "]"}]}]}], "]"}]}], ")"}], 
            "*", 
            FractionBox[
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"t", "[", "i", "]"}], "]"}], "2"]}], "+", 
           "\[IndentingNewLine]", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "2"}], 
                RowBox[{"Omega", "[", 
                 RowBox[{
                  RowBox[{"t", "[", 
                   RowBox[{"a", "+", "1"}], "]"}], ",", 
                  RowBox[{"Et2", "[", 
                   RowBox[{"i", ",", "j"}], "]"}]}], "]"}]}], "]"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "2"}], 
                  RowBox[{"io", "[", "a", "]"}]}], "]"}]}], ")"}], "*", 
              FractionBox[
               RowBox[{"\[Lambda]", "[", 
                RowBox[{"t", "[", "a", "]"}], "]"}], "2"]}], ",", 
             RowBox[{"{", 
              RowBox[{"a", ",", 
               RowBox[{"i", "+", "1"}], ",", 
               RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "2"}], 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Et2", "[", 
                    RowBox[{"i", ",", "j"}], "]"}], "-", 
                   RowBox[{"t", "[", "j", "]"}]}], ")"}], "/", 
                 RowBox[{"\[Lambda]", "[", 
                  RowBox[{"t", "[", "j", "]"}], "]"}]}]}], "]"}]}], ")"}], 
            "*", 
            FractionBox[
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"t", "[", "j", "]"}], "]"}], "2"]}]}], ")"}], 
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           RowBox[{"Omega", "[", 
            RowBox[{
             RowBox[{"Et2", "[", 
              RowBox[{"i", ",", "j"}], "]"}], ",", 
             RowBox[{"t", "[", "l", "]"}]}], "]"}]}], "]"}], 
         RowBox[{"\[Lambda]", "[", 
          RowBox[{"t", "[", "l", "]"}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             RowBox[{"io", "[", "l", "]"}]}], "]"}]}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "0", "<=", "i", "\[Equal]", "k", "<", "j", "<", "l", "\[LessEqual]", 
         "n"}], "&&", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "}"}], "\[Element]", 
         "Integers"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"case", " ", "B"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         FractionBox["1", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"Et2", "[", 
             RowBox[{"i", ",", "j"}], "]"}]}], "+", 
           RowBox[{"Et3", "[", 
            RowBox[{"i", ",", "j"}], "]"}]}]], "*", 
         FractionBox["1", 
          RowBox[{"\[Lambda]", "[", 
           RowBox[{"t", "[", "l", "]"}], "]"}]], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "3"}], 
                RowBox[{"Omega", "[", 
                 RowBox[{
                  RowBox[{"t", "[", 
                   RowBox[{"a", "+", "1"}], "]"}], ",", 
                  RowBox[{"Et3", "[", 
                   RowBox[{"i", ",", "j"}], "]"}]}], "]"}]}], "]"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "3"}], 
                  RowBox[{"io", "[", "a", "]"}]}], "]"}]}], ")"}], "*", 
              FractionBox[
               RowBox[{"\[Lambda]", "[", 
                RowBox[{"t", "[", "a", "]"}], "]"}], "3"]}], ",", 
             RowBox[{"{", 
              RowBox[{"a", ",", "0", ",", 
               RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "3"}], 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Et3", "[", 
                    RowBox[{"i", ",", "j"}], "]"}], "-", 
                   RowBox[{"t", "[", "i", "]"}]}], ")"}], "/", 
                 RowBox[{"\[Lambda]", "[", 
                  RowBox[{"t", "[", "i", "]"}], "]"}]}]}], "]"}]}], ")"}], 
            "*", 
            FractionBox[
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"t", "[", "i", "]"}], "]"}], "3"]}]}], ")"}], "*", 
         "\[IndentingNewLine]", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "2"}], 
           RowBox[{"(*", 
            RowBox[{"notice", " ", "the", " ", "2"}], "*)"}], 
           RowBox[{"Omega", "[", 
            RowBox[{
             RowBox[{"Et3", "[", 
              RowBox[{"i", ",", "j"}], "]"}], ",", 
             RowBox[{"t", "[", "l", "]"}]}], "]"}]}], "]"}], "*", 
         FractionBox[
          RowBox[{"\[Lambda]", "[", 
           RowBox[{"t", "[", "l", "]"}], "]"}], "2"], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "2"}], 
             RowBox[{"io", "[", "l", "]"}]}], "]"}]}], ")"}]}], "+", 
        "\[IndentingNewLine]", 
        RowBox[{
         FractionBox["2", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"Et2", "[", 
             RowBox[{"i", ",", "j"}], "]"}]}], "+", 
           RowBox[{"Et3", "[", 
            RowBox[{"i", ",", "j"}], "]"}]}]], "*", 
         FractionBox["1", 
          RowBox[{"\[Lambda]", "[", 
           RowBox[{"t", "[", "l", "]"}], "]"}]], "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "2"}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"t", "[", 
                 RowBox[{"i", "+", "1"}], "]"}], "-", 
                RowBox[{"Et3", "[", 
                 RowBox[{"i", ",", "j"}], "]"}]}], ")"}], "/", 
              RowBox[{"\[Lambda]", "[", 
               RowBox[{"t", "[", "i", "]"}], "]"}]}]}], "]"}]}], ")"}], "*", 
         FractionBox[
          RowBox[{"\[Lambda]", "[", 
           RowBox[{"t", "[", "i", "]"}], "]"}], "2"], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "2"}], 
           RowBox[{"Omega", "[", 
            RowBox[{
             RowBox[{"t", "[", 
              RowBox[{"i", "+", "1"}], "]"}], ",", 
             RowBox[{"t", "[", "l", "]"}]}], "]"}]}], "]"}], "*", 
         FractionBox[
          RowBox[{"\[Lambda]", "[", 
           RowBox[{"t", "[", "l", "]"}], "]"}], "2"], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "2"}], 
             RowBox[{"io", "[", "l", "]"}]}], "]"}]}], ")"}]}], "+", 
        "\[IndentingNewLine]", 
        RowBox[{
         FractionBox["2", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"Et2", "[", 
             RowBox[{"i", ",", "j"}], "]"}]}], "+", 
           RowBox[{"Et3", "[", 
            RowBox[{"i", ",", "j"}], "]"}]}]], "*", 
         FractionBox["1", 
          RowBox[{"\[Lambda]", "[", 
           RowBox[{"t", "[", "l", "]"}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"\[Lambda]", "[", 
             RowBox[{"t", "[", "l", "]"}], "]"}], "2"], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "2"}], 
               RowBox[{"io", "[", "l", "]"}]}], "]"}]}], ")"}], 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "2"}], 
                  RowBox[{"io", "[", "a", "]"}]}], "]"}]}], ")"}], "*", 
              FractionBox[
               RowBox[{"\[Lambda]", "[", 
                RowBox[{"t", "[", "a", "]"}], "]"}], "2"], 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "2"}], 
                RowBox[{"Omega", "[", 
                 RowBox[{
                  RowBox[{"t", "[", 
                   RowBox[{"a", "+", "1"}], "]"}], ",", 
                  RowBox[{"t", "[", "l", "]"}]}], "]"}]}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"a", ",", 
               RowBox[{"i", "+", "1"}], ",", 
               RowBox[{"l", "-", "1"}]}], "}"}]}], "]"}]}], ")"}]}], "+", 
        "\[IndentingNewLine]", 
        RowBox[{
         FractionBox["2", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"Et2", "[", 
             RowBox[{"i", ",", "j"}], "]"}]}], "+", 
           RowBox[{"Et3", "[", 
            RowBox[{"i", ",", "j"}], "]"}]}]], "*", 
         FractionBox["1", 
          RowBox[{"\[Lambda]", "[", 
           RowBox[{"t", "[", "l", "]"}], "]"}]], "*", 
         FractionBox[
          RowBox[{"\[Lambda]", "[", 
           RowBox[{"t", "[", "l", "]"}], "]"}], "2"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"t", "[", 
            RowBox[{"l", "+", "1"}], "]"}], "-", 
           RowBox[{"t", "[", "l", "]"}], "-", 
           RowBox[{
            FractionBox[
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"t", "[", "l", "]"}], "]"}], "2"], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "2"}], 
                RowBox[{"io", "[", "l", "]"}]}], "]"}]}], ")"}]}]}], 
          ")"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "0", "<=", "i", "\[Equal]", "k", "<", "l", "<", "j", "\[LessEqual]", 
         "n"}], "&&", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "}"}], "\[Element]", 
         "Integers"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"(*", " ", 
       RowBox[{"case", " ", "C"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        FractionBox["1", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"Et2", "[", 
            RowBox[{"i", ",", "j"}], "]"}]}], "+", 
          RowBox[{"Et3", "[", 
           RowBox[{"i", ",", "j"}], "]"}]}]], "*", 
        FractionBox["2", 
         RowBox[{"\[Lambda]", "[", 
          RowBox[{"t", "[", "k", "]"}], "]"}]], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"\[Lambda]", "[", 
             RowBox[{"t", "[", "k", "]"}], "]"}], "3"], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "3"}], 
               RowBox[{"io", "[", "k", "]"}]}], "]"}]}], ")"}], 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "3"}], 
                  RowBox[{"io", "[", "a", "]"}]}], "]"}]}], ")"}], "*", 
              FractionBox[
               RowBox[{"\[Lambda]", "[", 
                RowBox[{"t", "[", "a", "]"}], "]"}], "3"], 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "3"}], 
                RowBox[{"Omega", "[", 
                 RowBox[{
                  RowBox[{"t", "[", 
                   RowBox[{"a", "+", "1"}], "]"}], ",", 
                  RowBox[{"t", "[", "k", "]"}]}], "]"}]}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"a", ",", "0", ",", 
               RowBox[{"k", "-", "1"}]}], "}"}]}], "]"}]}], "+", 
          RowBox[{
           FractionBox[
            RowBox[{"\[Lambda]", "[", 
             RowBox[{"t", "[", "k", "]"}], "]"}], "3"], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"t", "[", 
              RowBox[{"k", "+", "1"}], "]"}], "-", 
             RowBox[{"t", "[", "k", "]"}], "-", 
             RowBox[{
              FractionBox[
               RowBox[{"\[Lambda]", "[", 
                RowBox[{"t", "[", "k", "]"}], "]"}], "3"], 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "3"}], 
                  RowBox[{"io", "[", "k", "]"}]}], "]"}]}], ")"}]}]}], 
            ")"}]}]}], ")"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "0", "\[LessEqual]", "k", "<", "i", "\[Equal]", "l", "<", "j", 
         "\[LessEqual]", "n"}], "&&", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "}"}], "\[Element]", 
         "Integers"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"case", " ", "D"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        FractionBox["2", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"Et2", "[", 
            RowBox[{"i", ",", "j"}], "]"}]}], "+", 
          RowBox[{"Et3", "[", 
           RowBox[{"i", ",", "j"}], "]"}]}]], "*", 
        FractionBox["2", 
         RowBox[{"\[Lambda]", "[", 
          RowBox[{"t", "[", "k", "]"}], "]"}]], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"\[Lambda]", "[", 
             RowBox[{"t", "[", "k", "]"}], "]"}], "3"], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "3"}], 
               RowBox[{"io", "[", "k", "]"}]}], "]"}]}], ")"}], 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "3"}], 
                  RowBox[{"io", "[", "a", "]"}]}], "]"}]}], ")"}], "*", 
              FractionBox[
               RowBox[{"\[Lambda]", "[", 
                RowBox[{"t", "[", "a", "]"}], "]"}], "3"], 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "3"}], 
                RowBox[{"Omega", "[", 
                 RowBox[{
                  RowBox[{"t", "[", 
                   RowBox[{"a", "+", "1"}], "]"}], ",", 
                  RowBox[{"t", "[", "k", "]"}]}], "]"}]}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"a", ",", "0", ",", 
               RowBox[{"k", "-", "1"}]}], "}"}]}], "]"}]}], "+", 
          RowBox[{
           FractionBox[
            RowBox[{"\[Lambda]", "[", 
             RowBox[{"t", "[", "k", "]"}], "]"}], "3"], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"t", "[", 
              RowBox[{"k", "+", "1"}], "]"}], "-", 
             RowBox[{"t", "[", "k", "]"}], "-", 
             RowBox[{
              FractionBox[
               RowBox[{"\[Lambda]", "[", 
                RowBox[{"t", "[", "k", "]"}], "]"}], "3"], 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "3"}], 
                  RowBox[{"io", "[", "k", "]"}]}], "]"}]}], ")"}]}]}], 
            ")"}]}]}], ")"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "0", "\[LessEqual]", "k", "<", "i", "<", "j", "\[Equal]", "l", 
         "\[LessEqual]", "n"}], "&&", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "}"}], "\[Element]", 
         "Integers"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"(*", " ", 
       RowBox[{"case", " ", "E"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        FractionBox["2", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"Et2", "[", 
            RowBox[{"i", ",", "j"}], "]"}]}], "+", 
          RowBox[{"Et3", "[", 
           RowBox[{"i", ",", "j"}], "]"}]}]], "*", 
        FractionBox["2", 
         RowBox[{"\[Lambda]", "[", 
          RowBox[{"t", "[", "k", "]"}], "]"}]], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "3"}], 
               RowBox[{"Omega", "[", 
                RowBox[{
                 RowBox[{"t", "[", 
                  RowBox[{"a", "+", "1"}], "]"}], ",", 
                 RowBox[{"Et3", "[", 
                  RowBox[{"i", ",", "j"}], "]"}]}], "]"}]}], "]"}], 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "3"}], 
                 RowBox[{"io", "[", "a", "]"}]}], "]"}]}], ")"}], "*", 
             FractionBox[
              RowBox[{"\[Lambda]", "[", 
               RowBox[{"t", "[", "a", "]"}], "]"}], "3"]}], ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "0", ",", 
              RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "3"}], 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Et3", "[", 
                   RowBox[{"i", ",", "j"}], "]"}], "-", 
                  RowBox[{"t", "[", "i", "]"}]}], ")"}], "/", 
                RowBox[{"\[Lambda]", "[", 
                 RowBox[{"t", "[", "i", "]"}], "]"}]}]}], "]"}]}], ")"}], "*", 
           FractionBox[
            RowBox[{"\[Lambda]", "[", 
             RowBox[{"t", "[", "i", "]"}], "]"}], "3"]}]}], ")"}], "*", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "2"}], 
          RowBox[{"Omega", "[", 
           RowBox[{
            RowBox[{"Et3", "[", 
             RowBox[{"i", ",", "j"}], "]"}], ",", 
            RowBox[{"t", "[", "k", "]"}]}], "]"}]}], "]"}], "*", 
        FractionBox[
         RowBox[{"\[Lambda]", "[", 
          RowBox[{"t", "[", "k", "]"}], "]"}], "2"], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "2"}], 
            RowBox[{"io", "[", "k", "]"}]}], "]"}]}], ")"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "0", "\[LessEqual]", "i", "<", "k", "<", "j", "\[Equal]", "l"}], "&&", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "}"}], "\[Element]", 
         "Integers"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"case", " ", "F"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        FractionBox["2", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"Et2", "[", 
            RowBox[{"i", ",", "j"}], "]"}]}], "+", 
          RowBox[{"Et3", "[", 
           RowBox[{"i", ",", "j"}], "]"}]}]], 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "2"}], 
          RowBox[{"Omega", "[", 
           RowBox[{
            RowBox[{"Et3", "[", 
             RowBox[{"i", ",", "j"}], "]"}], ",", 
            RowBox[{"Et2", "[", 
             RowBox[{"i", ",", "j"}], "]"}]}], "]"}]}], "]"}], "*", 
        FractionBox["1", 
         RowBox[{"\[Lambda]", "[", 
          RowBox[{"t", "[", "l", "]"}], "]"}]], "*", "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "3"}], 
               RowBox[{"Omega", "[", 
                RowBox[{
                 RowBox[{"t", "[", 
                  RowBox[{"a", "+", "1"}], "]"}], ",", 
                 RowBox[{"Et3", "[", 
                  RowBox[{"i", ",", "j"}], "]"}]}], "]"}]}], "]"}], "*", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "3"}], 
                 RowBox[{"io", "[", "a", "]"}]}], "]"}]}], ")"}], "*", 
             FractionBox[
              RowBox[{"\[Lambda]", "[", 
               RowBox[{"t", "[", "a", "]"}], "]"}], "3"]}], ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "0", ",", 
              RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "3"}], 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Et3", "[", 
                   RowBox[{"i", ",", "j"}], "]"}], "-", 
                  RowBox[{"t", "[", "i", "]"}]}], ")"}], "/", 
                RowBox[{"\[Lambda]", "[", 
                 RowBox[{"t", "[", "i", "]"}], "]"}]}]}], "]"}]}], ")"}], "*", 
           FractionBox[
            RowBox[{"\[Lambda]", "[", 
             RowBox[{"t", "[", "i", "]"}], "]"}], "3"]}]}], ")"}], 
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          RowBox[{"Omega", "[", 
           RowBox[{
            RowBox[{"Et2", "[", 
             RowBox[{"i", ",", "j"}], "]"}], ",", 
            RowBox[{"t", "[", "l", "]"}]}], "]"}]}], "]"}], 
        RowBox[{"\[Lambda]", "[", 
         RowBox[{"t", "[", "l", "]"}], "]"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"Exp", "[", 
           RowBox[{"-", 
            RowBox[{"io", "[", "l", "]"}]}], "]"}]}], ")"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "0", "\[LessEqual]", "i", "<", "j", "\[Equal]", "k", "<", "l"}], "&&", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "}"}], "\[Element]", 
         "Integers"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"case", " ", "G", " ", "and", " ", "G2"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         FractionBox["1", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"Et2", "[", 
             RowBox[{"i", ",", "j"}], "]"}]}], "+", 
           RowBox[{"Et3", "[", 
            RowBox[{"i", ",", "j"}], "]"}]}]], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            FractionBox["1", 
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"t", "[", "k", "]"}], "]"}]], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", "3"}], 
                   RowBox[{"Omega", "[", 
                    RowBox[{
                    RowBox[{"t", "[", 
                    RowBox[{"a", "+", "1"}], "]"}], ",", 
                    RowBox[{"Et3", "[", 
                    RowBox[{"i", ",", "j"}], "]"}]}], "]"}]}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "3"}], 
                    RowBox[{"io", "[", "a", "]"}]}], "]"}]}], ")"}], "*", 
                 FractionBox[
                  RowBox[{"\[Lambda]", "[", 
                   RowBox[{"t", "[", "a", "]"}], "]"}], "3"]}], ",", 
                RowBox[{"{", 
                 RowBox[{"a", ",", "0", ",", 
                  RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", "3"}], 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Et3", "[", 
                    RowBox[{"i", ",", "j"}], "]"}], "-", 
                    RowBox[{"t", "[", "i", "]"}]}], ")"}], "/", 
                    RowBox[{"\[Lambda]", "[", 
                    RowBox[{"t", "[", "i", "]"}], "]"}]}]}], "]"}]}], ")"}], 
               "*", 
               FractionBox[
                RowBox[{"\[Lambda]", "[", 
                 RowBox[{"t", "[", "i", "]"}], "]"}], "3"]}]}], ")"}], "*", 
            FractionBox[
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"t", "[", "k", "]"}], "]"}], "2"], "*", 
            "\[IndentingNewLine]", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "2"}], 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"t", "[", 
                    RowBox[{"k", "+", "1"}], "]"}], "-", 
                   RowBox[{"Et3", "[", 
                    RowBox[{"i", ",", "j"}], "]"}]}], ")"}], "/", 
                 RowBox[{"\[Lambda]", "[", 
                  RowBox[{"t", "[", "k", "]"}], "]"}]}]}], "]"}]}], ")"}]}], 
           "+", 
           RowBox[{"t", "[", 
            RowBox[{"k", "+", "1"}], "]"}], "-", 
           RowBox[{"Et3", "[", 
            RowBox[{"i", ",", "j"}], "]"}], "-", 
           RowBox[{
            FractionBox[
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"t", "[", "k", "]"}], "]"}], "2"], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "2"}], 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"t", "[", 
                    RowBox[{"k", "+", "1"}], "]"}], "-", 
                   RowBox[{"Et3", "[", 
                    RowBox[{"i", ",", "j"}], "]"}]}], ")"}], "/", 
                 RowBox[{"\[Lambda]", "[", 
                  RowBox[{"t", "[", "k", "]"}], "]"}]}]}], "]"}]}], ")"}]}]}],
           ")"}]}], "+", "\[IndentingNewLine]", 
        RowBox[{
         FractionBox["1", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"Et2", "[", 
             RowBox[{"i", ",", "j"}], "]"}]}], "+", 
           RowBox[{"Et3", "[", 
            RowBox[{"i", ",", "j"}], "]"}]}]], "*", 
         FractionBox["2", 
          RowBox[{"\[Lambda]", "[", 
           RowBox[{"t", "[", "k", "]"}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", "3"}], 
                   RowBox[{"io", "[", "a", "]"}]}], "]"}]}], ")"}], "*", 
               FractionBox[
                RowBox[{"\[Lambda]", "[", 
                 RowBox[{"t", "[", "a", "]"}], "]"}], "3"], "*", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "3"}], 
                 RowBox[{"Omega", "[", 
                  RowBox[{
                   RowBox[{"t", "[", 
                    RowBox[{"a", "+", "1"}], "]"}], ",", 
                   RowBox[{"t", "[", "k", "]"}]}], "]"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"a", ",", "0", ",", 
                RowBox[{"k", "-", "1"}]}], "}"}]}], "]"}], "*", 
            FractionBox[
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"t", "[", "k", "]"}], "]"}], "3"], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "3"}], 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Et3", "[", 
                    RowBox[{"i", ",", "j"}], "]"}], "-", 
                   RowBox[{"t", "[", "k", "]"}]}], ")"}], "/", 
                 RowBox[{"\[Lambda]", "[", 
                  RowBox[{"t", "[", "k", "]"}], "]"}]}]}], "]"}]}], ")"}]}], 
           "+", 
           RowBox[{
            FractionBox[
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"t", "[", "k", "]"}], "]"}], "3"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Et3", "[", 
               RowBox[{"i", ",", "j"}], "]"}], "-", 
              RowBox[{"t", "[", "k", "]"}], "-", 
              RowBox[{
               FractionBox[
                RowBox[{"\[Lambda]", "[", 
                 RowBox[{"t", "[", "k", "]"}], "]"}], "3"], 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", "3"}], 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Et3", "[", 
                    RowBox[{"i", ",", "j"}], "]"}], "-", 
                    RowBox[{"t", "[", "k", "]"}]}], ")"}], "/", 
                    RowBox[{"\[Lambda]", "[", 
                    RowBox[{"t", "[", "k", "]"}], "]"}]}]}], "]"}]}], 
                ")"}]}]}], ")"}]}]}], ")"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "0", "\[LessEqual]", "i", "\[Equal]", "k", "\[Equal]", "l", "<", "j", 
         "\[LessEqual]", "n"}], "&&", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "}"}], "\[Element]", 
         "Integers"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"case", " ", "H", " ", "and", " ", "H2"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         FractionBox["1", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"Et2", "[", 
             RowBox[{"i", ",", "j"}], "]"}]}], "+", 
           RowBox[{"Et3", "[", 
            RowBox[{"i", ",", "j"}], "]"}]}]], "*", 
         FractionBox["4", 
          RowBox[{"\[Lambda]", "[", 
           RowBox[{"t", "[", "k", "]"}], "]"}]], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "2"}], 
           RowBox[{"Omega", "[", 
            RowBox[{
             RowBox[{"Et3", "[", 
              RowBox[{"i", ",", "j"}], "]"}], ",", 
             RowBox[{"t", "[", "k", "]"}]}], "]"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "3"}], 
                RowBox[{"Omega", "[", 
                 RowBox[{
                  RowBox[{"t", "[", 
                   RowBox[{"a", "+", "1"}], "]"}], ",", 
                  RowBox[{"Et3", "[", 
                   RowBox[{"i", ",", "j"}], "]"}]}], "]"}]}], "]"}], "*", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "3"}], 
                  RowBox[{"io", "[", "a", "]"}]}], "]"}]}], ")"}], "*", 
              FractionBox[
               RowBox[{"\[Lambda]", "[", 
                RowBox[{"t", "[", "a", "]"}], "]"}], "3"]}], ",", 
             RowBox[{"{", 
              RowBox[{"a", ",", "0", ",", 
               RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "3"}], 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Et3", "[", 
                    RowBox[{"i", ",", "j"}], "]"}], "-", 
                   RowBox[{"t", "[", "i", "]"}]}], ")"}], "/", 
                 RowBox[{"\[Lambda]", "[", 
                  RowBox[{"t", "[", "i", "]"}], "]"}]}]}], "]"}]}], ")"}], 
            "*", 
            FractionBox[
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"t", "[", "i", "]"}], "]"}], "3"]}]}], ")"}], "*", 
         "\[IndentingNewLine]", 
         FractionBox[
          RowBox[{"\[Lambda]", "[", 
           RowBox[{"t", "[", "k", "]"}], "]"}], "2"], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "2"}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Et2", "[", 
                 RowBox[{"i", ",", "j"}], "]"}], "-", 
                RowBox[{"t", "[", "k", "]"}]}], ")"}], "/", 
              RowBox[{"\[Lambda]", "[", 
               RowBox[{"t", "[", "k", "]"}], "]"}]}]}], "]"}]}], ")"}]}], "+",
         "\[IndentingNewLine]", 
        RowBox[{
         FractionBox["2", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"Et2", "[", 
             RowBox[{"i", ",", "j"}], "]"}]}], "+", 
           RowBox[{"Et3", "[", 
            RowBox[{"i", ",", "j"}], "]"}]}]], "*", 
         FractionBox["1", 
          RowBox[{"\[Lambda]", "[", 
           RowBox[{"t", "[", "k", "]"}], "]"}]], 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "2"}], 
           RowBox[{"Omega", "[", 
            RowBox[{
             RowBox[{"Et3", "[", 
              RowBox[{"i", ",", "j"}], "]"}], ",", 
             RowBox[{"Et2", "[", 
              RowBox[{"i", ",", "j"}], "]"}]}], "]"}]}], "]"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "3"}], 
                RowBox[{"Omega", "[", 
                 RowBox[{
                  RowBox[{"t", "[", 
                   RowBox[{"a", "+", "1"}], "]"}], ",", 
                  RowBox[{"Et3", "[", 
                   RowBox[{"i", ",", "j"}], "]"}]}], "]"}]}], "]"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "3"}], 
                  RowBox[{"io", "[", "a", "]"}]}], "]"}]}], ")"}], "*", 
              FractionBox[
               RowBox[{"\[Lambda]", "[", 
                RowBox[{"t", "[", "a", "]"}], "]"}], "3"]}], ",", 
             RowBox[{"{", 
              RowBox[{"a", ",", "0", ",", 
               RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}], "+", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "3"}], 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Et3", "[", 
                    RowBox[{"i", ",", "j"}], "]"}], "-", 
                   RowBox[{"t", "[", "i", "]"}]}], ")"}], "/", 
                 RowBox[{"\[Lambda]", "[", 
                  RowBox[{"t", "[", "i", "]"}], "]"}]}]}], "]"}]}], ")"}], 
            "*", 
            FractionBox[
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"t", "[", "i", "]"}], "]"}], "3"]}]}], ")"}], "*", 
         RowBox[{"\[Lambda]", "[", 
          RowBox[{"t", "[", "k", "]"}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"t", "[", 
                 RowBox[{"k", "+", "1"}], "]"}], "-", 
                RowBox[{"Et2", "[", 
                 RowBox[{"i", ",", "j"}], "]"}]}], ")"}]}], "/", 
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"t", "[", "k", "]"}], "]"}]}], "]"}]}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "0", "\[LessEqual]", "i", "<", "k", "\[Equal]", "l", "\[Equal]", 
         "j"}], "&&", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "}"}], "\[Element]", 
         "Integers"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"case", " ", "I", " ", "and", " ", "I2"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         FractionBox["1", 
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"Et2", "[", 
             RowBox[{"i", ",", "j"}], "]"}]}], "+", 
           RowBox[{"Et3", "[", 
            RowBox[{"i", ",", "j"}], "]"}]}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            FractionBox["1", 
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"t", "[", "l", "]"}], "]"}]], 
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "2"}], " ", 
               RowBox[{"Omega", "[", 
                RowBox[{
                 RowBox[{"Et3", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], ",", 
                 RowBox[{"Et2", "[", 
                  RowBox[{"i", ",", "j"}], "]"}]}], "]"}]}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"a", "=", "0"}], 
                 RowBox[{"i", "-", "1"}]], 
                RowBox[{
                 FractionBox["1", "3"], " ", 
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", "3"}], " ", 
                   RowBox[{"Omega", "[", 
                    RowBox[{
                    RowBox[{"t", "[", 
                    RowBox[{"a", "+", "1"}], "]"}], ",", 
                    RowBox[{"Et3", "[", 
                    RowBox[{"i", ",", "j"}], "]"}]}], "]"}]}], "]"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "3"}], " ", 
                    RowBox[{"io", "[", "a", "]"}]}], "]"}]}], ")"}], " ", 
                 RowBox[{"\[Lambda]", "[", 
                  RowBox[{"t", "[", "a", "]"}], "]"}]}]}], "+", 
               RowBox[{
                FractionBox["1", "3"], " ", 
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  RowBox[{"Exp", "[", 
                   RowBox[{"-", 
                    FractionBox[
                    RowBox[{"3", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Et3", "[", 
                    RowBox[{"i", ",", "j"}], "]"}], "-", 
                    RowBox[{"t", "[", "i", "]"}]}], ")"}]}], 
                    RowBox[{"\[Lambda]", "[", 
                    RowBox[{"t", "[", "i", "]"}], "]"}]]}], "]"}]}], ")"}], 
                " ", 
                RowBox[{"\[Lambda]", "[", 
                 RowBox[{"t", "[", "i", "]"}], "]"}]}]}], ")"}], " ", 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{"Omega", "[", 
                RowBox[{
                 RowBox[{"Et2", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], ",", 
                 RowBox[{"t", "[", "l", "]"}]}], "]"}]}], "]"}], " ", 
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"t", "[", "l", "]"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"Exp", "[", 
                RowBox[{"-", 
                 RowBox[{"io", "[", "l", "]"}]}], "]"}]}], ")"}]}]}], "+", 
           RowBox[{
            FractionBox["1", 
             RowBox[{
              RowBox[{"\[Lambda]", "[", 
               RowBox[{"t", "[", "l", "]"}], "]"}], " ", "2"}]], 
            RowBox[{"2", " ", 
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"t", "[", "i", "]"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"Exp", "[", 
                RowBox[{"-", 
                 FractionBox[
                  RowBox[{"2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Et2", "[", 
                    RowBox[{"i", ",", "j"}], "]"}], "-", 
                    RowBox[{"Et3", "[", 
                    RowBox[{"i", ",", "j"}], "]"}]}], ")"}]}], 
                  RowBox[{"\[Lambda]", "[", 
                   RowBox[{"t", "[", "i", "]"}], "]"}]]}], "]"}]}], ")"}], 
             " ", 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{"Omega", "[", 
                RowBox[{
                 RowBox[{"Et2", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], ",", 
                 RowBox[{"t", "[", "l", "]"}]}], "]"}]}], "]"}], " ", 
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"t", "[", "l", "]"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"Exp", "[", 
                RowBox[{"-", 
                 RowBox[{"io", "[", "l", "]"}]}], "]"}]}], ")"}]}]}]}], 
          ")"}]}], "+", "\[IndentingNewLine]", 
        RowBox[{
         FractionBox["1", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              RowBox[{"Et2", "[", 
               RowBox[{"i", ",", "j"}], "]"}]}], "+", 
             RowBox[{"Et3", "[", 
              RowBox[{"i", ",", "j"}], "]"}]}], ")"}], " ", 
           RowBox[{"\[Lambda]", "[", 
            RowBox[{"t", "[", "l", "]"}], "]"}]}]], 
         RowBox[{"2", " ", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "2"}], " ", 
            RowBox[{"Omega", "[", 
             RowBox[{
              RowBox[{"Et3", "[", 
               RowBox[{"i", ",", "j"}], "]"}], ",", 
              RowBox[{"Et2", "[", 
               RowBox[{"i", ",", "j"}], "]"}]}], "]"}]}], "]"}], " ", 
          RowBox[{"Exp", "[", 
           RowBox[{"-", 
            RowBox[{"Omega", "[", 
             RowBox[{
              RowBox[{"Et2", "[", 
               RowBox[{"i", ",", "j"}], "]"}], ",", 
              RowBox[{"t", "[", "l", "]"}]}], "]"}]}], "]"}], " ", 
          RowBox[{"\[Lambda]", "[", 
           RowBox[{"t", "[", "l", "]"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              RowBox[{"io", "[", "l", "]"}]}], "]"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             UnderoverscriptBox["\[Sum]", 
              RowBox[{"a", "=", "0"}], 
              RowBox[{"i", "-", "1"}]], 
             RowBox[{
              FractionBox["1", "3"], " ", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "3"}], " ", 
                RowBox[{"Omega", "[", 
                 RowBox[{
                  RowBox[{"t", "[", 
                   RowBox[{"a", "+", "1"}], "]"}], ",", 
                  RowBox[{"Et3", "[", 
                   RowBox[{"i", ",", "j"}], "]"}]}], "]"}]}], "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "3"}], " ", 
                  RowBox[{"io", "[", "a", "]"}]}], "]"}]}], ")"}], " ", 
              RowBox[{"\[Lambda]", "[", 
               RowBox[{"t", "[", "a", "]"}], "]"}]}]}], "+", 
            RowBox[{
             FractionBox["1", "3"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"Exp", "[", 
                RowBox[{"-", 
                 FractionBox[
                  RowBox[{"3", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Et3", "[", 
                    RowBox[{"i", ",", "j"}], "]"}], "-", 
                    RowBox[{"t", "[", "i", "]"}]}], ")"}]}], 
                  RowBox[{"\[Lambda]", "[", 
                   RowBox[{"t", "[", "i", "]"}], "]"}]]}], "]"}]}], ")"}], 
             " ", 
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"t", "[", "i", "]"}], "]"}]}]}], ")"}]}]}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "0", "\[LessEqual]", "i", "\[Equal]", "j", "\[Equal]", "k", "<", 
         "l"}], "&&", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "}"}], "\[Element]", 
         "Integers"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"case", " ", "J", " ", "and", " ", "J2"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         FractionBox["2", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"Et2", "[", 
             RowBox[{"i", ",", "j"}], "]"}]}], "+", 
           RowBox[{"Et3", "[", 
            RowBox[{"i", ",", "j"}], "]"}]}]], "*", 
         FractionBox["2", 
          RowBox[{"\[Lambda]", "[", 
           RowBox[{"t", "[", "k", "]"}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"t", "[", "k", "]"}], "]"}], "3"], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "3"}], 
                RowBox[{"io", "[", "k", "]"}]}], "]"}]}], ")"}], 
            RowBox[{"(", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{"-", "3"}], 
                    RowBox[{"io", "[", "a", "]"}]}], "]"}]}], ")"}], 
                FractionBox[
                 RowBox[{"\[Lambda]", "[", 
                  RowBox[{"t", "[", "a", "]"}], "]"}], "3"], 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "3"}], 
                  RowBox[{"Omega", "[", 
                   RowBox[{
                    RowBox[{"t", "[", 
                    RowBox[{"a", "+", "1"}], "]"}], ",", 
                    RowBox[{"t", "[", "k", "]"}]}], "]"}]}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"a", ",", "0", ",", 
                 RowBox[{"k", "-", "1"}]}], "}"}]}], "]"}], ")"}]}], "+", 
           RowBox[{
            FractionBox[
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"t", "[", "k", "]"}], "]"}], "3"], "*", 
            "\[IndentingNewLine]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"t", "[", 
               RowBox[{"k", "+", "1"}], "]"}], "-", 
              RowBox[{"t", "[", "k", "]"}], "-", 
              RowBox[{
               FractionBox[
                RowBox[{"\[Lambda]", "[", 
                 RowBox[{"t", "[", "k", "]"}], "]"}], "3"], 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", "3"}], 
                   RowBox[{"io", "[", "k", "]"}]}], "]"}]}], ")"}]}]}], 
             ")"}]}]}], ")"}]}], "+", "\[IndentingNewLine]", 
        RowBox[{
         FractionBox["2", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"Et2", "[", 
             RowBox[{"i", ",", "j"}], "]"}]}], "+", 
           RowBox[{"Et3", "[", 
            RowBox[{"i", ",", "j"}], "]"}]}]], 
         FractionBox["1", 
          RowBox[{"\[Lambda]", "[", 
           RowBox[{"t", "[", "k", "]"}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", "3"}], 
                   RowBox[{"io", "[", "a", "]"}]}], "]"}]}], ")"}], 
               FractionBox[
                RowBox[{"\[Lambda]", "[", 
                 RowBox[{"t", "[", "a", "]"}], "]"}], "3"], 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "3"}], 
                 RowBox[{"Omega", "[", 
                  RowBox[{
                   RowBox[{"t", "[", 
                    RowBox[{"a", "+", "1"}], "]"}], ",", 
                   RowBox[{"t", "[", "k", "]"}]}], "]"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"a", ",", "0", ",", 
                RowBox[{"k", "-", "1"}]}], "}"}]}], "]"}], 
            FractionBox[
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"t", "[", "k", "]"}], "]"}], "3"], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "3"}], 
                RowBox[{"io", "[", "k", "]"}]}], "]"}]}], ")"}]}], "+", 
           "\[IndentingNewLine]", 
           RowBox[{
            FractionBox[
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"t", "[", "k", "]"}], "]"}], "3"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"t", "[", 
               RowBox[{"k", "+", "1"}], "]"}], "-", 
              RowBox[{"t", "[", "k", "]"}], "-", 
              RowBox[{
               FractionBox[
                RowBox[{"\[Lambda]", "[", 
                 RowBox[{"t", "[", "k", "]"}], "]"}], "3"], 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", "3"}], 
                   RowBox[{"io", "[", "k", "]"}]}], "]"}]}], ")"}]}]}], 
             ")"}]}]}], ")"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "0", "\[LessEqual]", "k", "<", "i", "\[Equal]", "j", "\[Equal]", 
         "l"}], "&&", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "}"}], "\[Element]", 
         "Integers"}]}]}], "\[IndentingNewLine]", "}"}]}], 
    "\[IndentingNewLine]", "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.658658692209249*^9, 3.65865885098007*^9}, {
   3.658658883526136*^9, 3.658659019520296*^9}, {3.658659052548646*^9, 
   3.658659359002198*^9}, {3.658662768005818*^9, 3.658663231400346*^9}, {
   3.658667665498612*^9, 3.658667678075491*^9}, {3.6586677117473173`*^9, 
   3.6586677251806993`*^9}, {3.658667807346325*^9, 3.6586678083488293`*^9}, {
   3.6586685221351023`*^9, 3.658668524903118*^9}, {3.658669183998908*^9, 
   3.6586693698504677`*^9}, {3.658669638536708*^9, 3.658669640858*^9}, {
   3.658670176905149*^9, 3.658670189694375*^9}, {3.658670337222785*^9, 
   3.658670350699739*^9}, {3.658670446618513*^9, 3.658670463282909*^9}, {
   3.6586707821718063`*^9, 3.658670952747768*^9}, {3.658670998880632*^9, 
   3.6586710219771442`*^9}, {3.658674461368763*^9, 3.658674656019327*^9}, {
   3.65867476513974*^9, 3.658674765542746*^9}, 3.658674809419195*^9, {
   3.6586769007544193`*^9, 3.658676934076293*^9}, {3.658677083254965*^9, 
   3.65867731715968*^9}, {3.6586773604965076`*^9, 3.658677360958087*^9}, {
   3.658677423383503*^9, 3.658677578459546*^9}, {3.658677746425311*^9, 
   3.658677768288657*^9}, {3.6586793152257566`*^9, 3.658679316955922*^9}, 
   3.658679542138083*^9, {3.65868035048621*^9, 3.658680357300234*^9}, {
   3.658680407534115*^9, 3.658680713916224*^9}, {3.658701464554626*^9, 
   3.658701500419712*^9}, {3.658746854815311*^9, 3.658746855394679*^9}, {
   3.65875696026155*^9, 3.658757226276622*^9}, {3.658757285765923*^9, 
   3.6587573317844257`*^9}, {3.658758673701679*^9, 3.658758673790699*^9}, {
   3.658760708834363*^9, 3.658760729495008*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["exporting qts", "Section",
 CellChangeTimes->{{3.6591795079493093`*^9, 3.6591795124147167`*^9}, {
  3.6593541476774178`*^9, 3.6593541483863173`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"numStates", " ", "=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"n", "+", "1"}], ")"}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"n", "+", "2"}], ")"}], "/", "2"}]}]}]], "Input",
 CellChangeTimes->{{3.658766450171528*^9, 3.658766478726645*^9}}],

Cell[BoxData["66"], "Output",
 CellChangeTimes->{3.6587664790478687`*^9, 3.658767936414324*^9, 
  3.65917672478181*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getIndex", "[", 
    RowBox[{"i_", ",", "j_", ",", "n_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"i", "*", "n"}], "-", 
    RowBox[{"i", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"i", "-", "1"}], ")"}], "/", "2"}]}], "+", "j", "+", "1"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.658767008604363*^9, 3.65876704384787*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"allqts", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "numStates"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "numStates"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6587664871077127`*^9, 3.65876650692877*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "0"}], ",", 
   RowBox[{"i", "\[LessEqual]", "n"}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "i", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j", "=", "i"}], ",", 
      RowBox[{"j", "\[LessEqual]", "n"}], ",", 
      RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", "0"}], ",", 
        RowBox[{"k", "\[LessEqual]", "n"}], ",", 
        RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"l", "=", "k"}], ",", 
          RowBox[{"l", "\[LessEqual]", "n"}], ",", 
          RowBox[{"l", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ijIdx", " ", "=", " ", 
            RowBox[{"getIndex", "[", 
             RowBox[{"i", ",", "j", ",", "n"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"klIdx", "=", 
            RowBox[{"getIndex", "[", 
             RowBox[{"k", ",", "l", ",", "n"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"allqts", "[", 
             RowBox[{"[", 
              RowBox[{"ijIdx", ",", "klIdx"}], "]"}], "]"}], "=", 
            RowBox[{"qts", "[", 
             RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",\

 CellChangeTimes->{{3.658766508615796*^9, 3.6587665429134617`*^9}, {
  3.658766616949048*^9, 3.658766710955241*^9}, {3.65876697549165*^9, 
  3.658766994948653*^9}, {3.658767077371747*^9, 3.658767079472995*^9}, {
  3.658767528280073*^9, 3.6587675390407963`*^9}, {3.658767641318569*^9, 
  3.6587676421958647`*^9}, {3.65876769523667*^9, 3.658767696165823*^9}, {
  3.6587679596057997`*^9, 3.658767993935412*^9}, {3.6587890507264757`*^9, 
  3.658789051292225*^9}}],

Cell[CellGroupData[{

Cell[BoxData["0"], "Print",
 CellChangeTimes->{3.658767995297554*^9, 3.658789052411457*^9}],

Cell[BoxData["1"], "Print",
 CellChangeTimes->{3.658767995297554*^9, 3.658789139829845*^9}],

Cell[BoxData["2"], "Print",
 CellChangeTimes->{3.658767995297554*^9, 3.6587892426069813`*^9}],

Cell[BoxData["3"], "Print",
 CellChangeTimes->{3.658767995297554*^9, 3.658789334801161*^9}],

Cell[BoxData["4"], "Print",
 CellChangeTimes->{3.658767995297554*^9, 3.658789409417955*^9}],

Cell[BoxData["5"], "Print",
 CellChangeTimes->{3.658767995297554*^9, 3.6587894752834272`*^9}],

Cell[BoxData["6"], "Print",
 CellChangeTimes->{3.658767995297554*^9, 3.658789537177862*^9}],

Cell[BoxData["7"], "Print",
 CellChangeTimes->{3.658767995297554*^9, 3.6587895825493307`*^9}],

Cell[BoxData["8"], "Print",
 CellChangeTimes->{3.658767995297554*^9, 3.658789613121359*^9}],

Cell[BoxData["9"], "Print",
 CellChangeTimes->{3.658767995297554*^9, 3.658789631323648*^9}],

Cell[BoxData["10"], "Print",
 CellChangeTimes->{3.658767995297554*^9, 3.658789639750684*^9}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<mathematica_qtsprobs.csv\>\"", ",", "allqts"}], "]"}]], "Input",\

 CellChangeTimes->{{3.658767711955941*^9, 3.6587677343913927`*^9}}],

Cell[BoxData["\<\"mathematica_qtsprobs.csv\"\>"], "Output",
 CellChangeTimes->{3.6587684568979397`*^9, 3.658789650175379*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"allintqts", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "numStates"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "numStates"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6587664871077127`*^9, 3.65876650692877*^9}, {
  3.6587689554233913`*^9, 3.65876895550445*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "0"}], ",", 
   RowBox[{"i", "\[LessEqual]", "n"}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "i", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j", "=", "i"}], ",", 
      RowBox[{"j", "\[LessEqual]", "n"}], ",", 
      RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", "0"}], ",", 
        RowBox[{"k", "\[LessEqual]", "n"}], ",", 
        RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"l", "=", "k"}], ",", 
          RowBox[{"l", "\[LessEqual]", "n"}], ",", 
          RowBox[{"l", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ijIdx", " ", "=", " ", 
            RowBox[{"getIndex", "[", 
             RowBox[{"i", ",", "j", ",", "n"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"klIdx", "=", 
            RowBox[{"getIndex", "[", 
             RowBox[{"k", ",", "l", ",", "n"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"allintqts", "[", 
             RowBox[{"[", 
              RowBox[{"ijIdx", ",", "klIdx"}], "]"}], "]"}], "=", 
            RowBox[{"intqts", "[", 
             RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",\

 CellChangeTimes->{{3.658766508615796*^9, 3.6587665429134617`*^9}, {
  3.658766616949048*^9, 3.658766710955241*^9}, {3.65876697549165*^9, 
  3.658766994948653*^9}, {3.658767077371747*^9, 3.658767079472995*^9}, {
  3.658767528280073*^9, 3.6587675390407963`*^9}, {3.658767641318569*^9, 
  3.6587676421958647`*^9}, {3.65876769523667*^9, 3.658767696165823*^9}, {
  3.6587679596057997`*^9, 3.658767993935412*^9}, {3.6587689440796423`*^9, 
  3.658768959097858*^9}, {3.658789654889065*^9, 3.658789655635571*^9}}],

Cell[CellGroupData[{

Cell[BoxData["0"], "Print",
 CellChangeTimes->{3.6587689745574627`*^9, 3.658789661206175*^9}],

Cell[BoxData["1"], "Print",
 CellChangeTimes->{3.6587689745574627`*^9, 3.658789871493103*^9}],

Cell[BoxData["2"], "Print",
 CellChangeTimes->{3.6587689745574627`*^9, 3.6587900862877197`*^9}],

Cell[BoxData["3"], "Print",
 CellChangeTimes->{3.6587689745574627`*^9, 3.658790267181243*^9}],

Cell[BoxData["4"], "Print",
 CellChangeTimes->{3.6587689745574627`*^9, 3.658790407621929*^9}],

Cell[BoxData["5"], "Print",
 CellChangeTimes->{3.6587689745574627`*^9, 3.658790550683029*^9}],

Cell[BoxData["6"], "Print",
 CellChangeTimes->{3.6587689745574627`*^9, 3.658790670394042*^9}],

Cell[BoxData["7"], "Print",
 CellChangeTimes->{3.6587689745574627`*^9, 3.658790755030457*^9}],

Cell[BoxData["8"], "Print",
 CellChangeTimes->{3.6587689745574627`*^9, 3.658790812670617*^9}],

Cell[BoxData["9"], "Print",
 CellChangeTimes->{3.6587689745574627`*^9, 3.658790845369499*^9}],

Cell[BoxData["10"], "Print",
 CellChangeTimes->{3.6587689745574627`*^9, 3.658790859961789*^9}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<mathematica_intqtsprobs.csv\>\"", ",", "allintqts"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.658767711955941*^9, 3.6587677343913927`*^9}, {
  3.658768940214553*^9, 3.6587689628234053`*^9}}],

Cell[BoxData["\<\"mathematica_intqtsprobs.csv\"\>"], "Output",
 CellChangeTimes->{3.6587697372734013`*^9, 3.65879086236506*^9}]
}, Closed]],

Cell[BoxData[
 RowBox[{
  RowBox[{"pts", "[", 
   RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_", ",", "\[Rho]_"}], "]"}], 
  ":="}]], "Input",
 CellChangeTimes->{{3.659176815843215*^9, 3.659176859626986*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["making pts transitions", "Section",
 CellChangeTimes->{{3.659179524983554*^9, 3.659179526023436*^9}, {
  3.659179634431872*^9, 3.659179635910562*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"pts", "[", 
   RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_", ",", "\[Rho]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"treeSize", ",", " ", "probRecomb"}], "}"}], ",", 
    RowBox[{
     RowBox[{"treeSize", "=", 
      RowBox[{
       RowBox[{"3", "*", 
        RowBox[{"Et3", "[", 
         RowBox[{"i", ",", "j"}], "]"}]}], "+", 
       RowBox[{"2", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Et2", "[", 
           RowBox[{"i", ",", "j"}], "]"}], "-", 
          RowBox[{"Et3", "[", 
           RowBox[{"i", ",", "j"}], "]"}]}], ")"}]}]}]}], ";", " ", 
     RowBox[{"probRecomb", "=", 
      RowBox[{"1", "-", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", "treeSize"}], "*", 
         RowBox[{"\[Rho]", "/", "2"}]}], "]"}]}]}], ";", 
     RowBox[{
      RowBox[{"qts", "[", 
       RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "*", 
      "probRecomb"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.659179638073477*^9, 3.659179729999238*^9}, {
  3.659179976220832*^9, 3.659180083514196*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["defining emission probabilities", "Section",
 CellChangeTimes->{{3.659269224756667*^9, 3.659269236128461*^9}, {
  3.659354163549467*^9, 3.659354164320109*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"emit", "[", 
   RowBox[{"k_", ",", "i_", ",", "j_", ",", "Td_", ",", "\[Theta]_"}], "]"}], 
  ":=", 
  RowBox[{"Piecewise", "[", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Exp", "[", 
        FractionBox[
         RowBox[{
          RowBox[{"-", "\[Theta]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", 
             RowBox[{"Et2", "[", 
              RowBox[{"i", ",", "j"}], "]"}]}], "+", 
            RowBox[{"Et3", "[", 
             RowBox[{"i", ",", "j"}], "]"}], "+", 
            RowBox[{"3", "Td"}]}], ")"}]}], "2"], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"k", "\[Equal]", "0"}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{
          FractionBox[
           RowBox[{"-", "\[Theta]"}], "2"], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Et2", "[", 
             RowBox[{"i", ",", "j"}], "]"}], "-", 
            RowBox[{"Et3", "[", 
             RowBox[{"i", ",", "j"}], "]"}]}], ")"}]}], "]"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"Exp", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"-", "\[Theta]"}], "2"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               RowBox[{"Et3", "[", 
                RowBox[{"i", ",", "j"}], "]"}]}], "+", 
              RowBox[{"Et2", "[", 
               RowBox[{"i", ",", "j"}], "]"}], "+", 
              RowBox[{"3", "Td"}]}], ")"}]}], "]"}]}], ")"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"k", "\[Equal]", "1"}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"Exp", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"-", "\[Theta]"}], "2"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Et2", "[", 
               RowBox[{"i", ",", "j"}], "]"}], "-", 
              RowBox[{"Et3", "[", 
               RowBox[{"i", ",", "j"}], "]"}]}], ")"}]}], "]"}]}], ")"}], 
        RowBox[{"Exp", "[", 
         RowBox[{
          FractionBox[
           RowBox[{"-", "\[Theta]"}], "2"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", 
             RowBox[{"Et3", "[", 
              RowBox[{"i", ",", "j"}], "]"}]}], "+", 
            RowBox[{"Et2", "[", 
             RowBox[{"i", ",", "j"}], "]"}], "+", 
            RowBox[{"3", "Td"}]}], ")"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"k", "\[Equal]", "2"}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"Exp", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"-", "\[Theta]"}], "2"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Et2", "[", 
               RowBox[{"i", ",", "j"}], "]"}], "-", 
              RowBox[{"Et3", "[", 
               RowBox[{"i", ",", "j"}], "]"}]}], ")"}]}], "]"}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"Exp", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"-", "\[Theta]"}], "2"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", 
               RowBox[{"Et3", "[", 
                RowBox[{"i", ",", "j"}], "]"}]}], "+", 
              RowBox[{"Et2", "[", 
               RowBox[{"i", ",", "j"}], "]"}], "+", 
              RowBox[{"3", "Td"}]}], ")"}]}], "]"}]}], ")"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"k", "\[Equal]", "3"}]}], "\[IndentingNewLine]", "}"}]}], 
    "\[IndentingNewLine]", "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.659269296209196*^9, 3.6592694523805313`*^9}, {
   3.659269487336707*^9, 3.65926969193566*^9}, 3.659269745538006*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["emissions exporting", "Section",
 CellChangeTimes->{{3.659275969488206*^9, 3.6592759721372623`*^9}, {
  3.659354172893309*^9, 3.6593541753939953`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"numStates", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"n", "+", "1"}], ")"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", "+", "2"}], ")"}], "/", "2"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6592760368531837`*^9, 3.659276057343848*^9}, {
  3.65927630308685*^9, 3.659276305019573*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Rho]", "=", "0.001"}], ";", 
  RowBox[{"\[Theta]", "=", "0.001"}], ";", 
  RowBox[{"Td", "=", "0.2"}], ";"}]], "Input",
 CellChangeTimes->{{3.659276306812994*^9, 3.659276328608396*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"emissionsout", " ", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "numStates"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.659275958920517*^9, 3.659276067114038*^9}, 
   3.6592764928551903`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getIndex", "[", 
    RowBox[{"i_", ",", "j_", ",", "n_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"i", "*", "n"}], "-", 
    RowBox[{"i", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"i", "-", "1"}], ")"}], "/", "2"}]}], "+", "j", "+", "1"}]}], 
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"state", ",", "i", ",", "j", ",", "k"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "0"}], ",", 
     RowBox[{"i", "\[LessEqual]", "n"}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", " ", "=", " ", "i"}], ",", " ", 
       RowBox[{"j", "\[LessEqual]", "n"}], ",", 
       RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"state", "=", 
         RowBox[{"getIndex", "[", 
          RowBox[{"i", ",", "j", ",", "n"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"emissionsout", "[", 
          RowBox[{"[", 
           RowBox[{"state", ",", "1"}], "]"}], "]"}], " ", "=", " ", "i"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"emissionsout", "[", 
          RowBox[{"[", 
           RowBox[{"state", ",", "2"}], "]"}], "]"}], " ", "=", " ", "j"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"k", "=", "0"}], ",", 
          RowBox[{"k", "\[LessEqual]", "3"}], ",", 
          RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"emissionsout", "[", 
             RowBox[{"[", 
              RowBox[{"state", ",", 
               RowBox[{"k", "+", "3"}]}], "]"}], "]"}], " ", "=", " ", 
            RowBox[{"emit", "[", 
             RowBox[{"k", ",", "i", ",", "j", ",", "Td", ",", "\[Theta]"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"emissionsout", "[", 
             RowBox[{"[", 
              RowBox[{"state", ",", 
               RowBox[{"k", "+", "3"}]}], "]"}], "]"}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.659276078650923*^9, 3.659276278846303*^9}, {
  3.659276339148654*^9, 3.659276370611847*^9}, {3.659276408052458*^9, 
  3.659276415941375*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"emissionsout", "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.6592764199687777`*^9, 3.659276422011183*^9}, {
  3.6592764734162817`*^9, 3.659276477429081*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"0", "0", "0.9996222803409488`", "0.00036171907822263164`", 
     "0.00001599479302066679`", "5.787807956645411`*^-9"},
    {"0", "1", "0.9995299739457553`", "0.0004195654894150824`", 
     "0.00005043939224975367`", "2.1172579959283654`*^-8"},
    {"0", "2", "0.9994186913693812`", "0.00047518187201908826`", 
     "0.00010607632373546684`", "5.04348643114303`*^-8"},
    {"0", "3", "0.9992934447054137`", "0.0005377734661851776`", 
     "0.00016869104668999614`", "9.078171119157886`*^-8"},
    {"0", "4", "0.999149220667205`", "0.0006098440744413147`", 
     "0.00024078829000418123`", "1.4696834948822634`*^-7"},
    {"0", "5", "0.9989815363757831`", "0.0006936315257905721`", 
     "0.0003246067114292759`", "2.2538699698835268`*^-7"},
    {"0", "6", "0.9987797194783758`", "0.0007944648093527193`", 
     "0.0004254772725597886`", "3.384397116159565`*^-7"},
    {"0", "7", "0.9985260216001087`", "0.0009212047857540086`", 
     "0.0005522641148007314`", "5.094993365715004`*^-7"},
    {"0", "8", "0.998183410930518`", "0.0010923373698087408`", 
     "0.0007234599990860763`", "7.917005871965223`*^-7"},
    {"0", "9", "0.9976483559032363`", "0.0013595362218549218`", 
     "0.0009907577288262898`", "1.3501460824867054`*^-6"},
    {"0", "10", "0.9952901602856633`", "0.0025363286760743215`", 
     "0.002167986291790806`", "5.524746471548393`*^-6"},
    {"1", "1", "0.999471369851085`", "0.0005109300904466168`", 
     "0.000017691014815914297`", "9.04365254738039`*^-9"},
    {"1", "2", "0.999368721786835`", "0.0005751472952866517`", 
     "0.00005609863252056552`", "3.2285357806470524`*^-8"},
    {"1", "3", "0.9992434813850313`", "0.0006377294944635694`", 
     "0.0001187133561793688`", "7.576432574511926`*^-8"},
    {"1", "4", "0.9990992645578294`", "0.0007097892839586914`", 
     "0.00019081060079083253`", "1.3555742108066932`*^-7"},
    {"1", "5", "0.9989315886503952`", "0.0007935641563819707`", 
     "0.0002746290243786754`", "2.1816884411825325`*^-7"},
    {"1", "6", "0.9987297818435598`", "0.0008943823000757768`", 
     "0.0003754995890454884`", "3.362673189820013`*^-7"},
    {"1", "7", "0.9984760966498434`", "0.0010211032438855602`", 
     "0.0005022864371787148`", "5.136690924137076`*^-7"},
    {"1", "8", "0.9981335031103227`", "0.0011922101237692568`", 
     "0.0006734823319802923`", "8.044339277908044`*^-7"},
    {"1", "9", "0.9975984748350686`", "0.0014593688306718373`", 
     "0.0009407800840288255`", "1.3762502307107944`*^-6"},
    {"1", "10", "0.9952403971240862`", "0.0026359843067871648`", 
     "0.002118008830960727`", "5.609738165956918`*^-6"},
    {"2", "2", "0.9993035765256811`", "0.0006766202402163093`", 
     "0.00001978983456818593`", "1.339953436964695`*^-8"},
    {"2", "3", "0.9991879695630617`", "0.0007487916527662645`", 
     "0.00006319142850370305`", "4.735566843407908`*^-8"},
    {"2", "4", "0.9990437607476597`", "0.0008208394216375537`", 
     "0.0001352886741334603`", "1.1115656930454551`*^-7"},
    {"2", "5", "0.9988760941552676`", "0.0009046003177342338`", 
     "0.00021910709963249343`", "1.9842736562135667`*^-7"},
    {"2", "6", "0.9986742985595771`", "0.0010054016396623608`", 
     "0.0003199776676363828`", "3.221331240435096`*^-7"},
    {"2", "7", "0.9984206274590498`", "0.0011321014365383967`", 
     "0.00044676452157209096`", "5.065828396928813`*^-7"},
    {"2", "8", "0.9980780529519191`", "0.0013031797567588496`", 
     "0.0006179604270527392`", "8.068642694139857`*^-7"},
    {"2", "9", "0.9975430543995452`", "0.0015702938587687882`", 
     "0.0008852582023171726`", "1.3935393689449436`*^-6"},
    {"2", "10", "0.995185107688857`", "0.002746712696168116`", 
     "0.002062487146721534`", "5.692468253207382`*^-6"},
    {"3", "3", "0.999114637133697`", "0.0008628890917285332`", 
     "0.000022454381763667556`", "1.939281075989689`*^-8"},
    {"3", "4", "0.998981323075461`", "0.0009457699720375953`", 
     "0.00007283799426743151`", "6.895823396327858`*^-8"},
    {"3", "5", "0.9988136669618009`", "0.0010295151451839041`", 
     "0.00015665642129769906`", "1.614717175495553`*^-7"},
    {"3", "6", "0.9986118839778174`", "0.0011302975431273915`", 
     "0.00025752699231103174`", "2.914867441179097`*^-7"},
    {"3", "7", "0.9983582287310832`", "0.001256973550333748`", 
     "0.0003843138518378223`", "4.838667453074555`*^-7"},
    {"3", "8", "0.9980156756339803`", "0.0014280197417846166`", 
     "0.0005555097680671553`", "7.948561680157661`*^-7"},
    {"3", "9", "0.9974807105176435`", "0.0016950836646200972`", 
     "0.0008228075674725243`", "1.3982502639321008`*^-6"},
    {"3", "10", "0.995122911172576`", "0.0028712812893224816`", 
     "0.002000036725307598`", "5.770812793935974`*^-6"},
    {"4", "4", "0.9988963116515347`", "0.0010778428868238605`", 
     "0.00002581760357442462`", "2.7858066991481114`*^-8"},
    {"4", "5", "0.9987413405882642`", "0.0011742476848901214`", 
     "0.00008431259820325516`", "9.912864244603067`*^-8"},
    {"4", "6", "0.9985395722158465`", "0.0012750081570558362`", 
     "0.00018518317171723075`", "2.3645538049633027`*^-7"},
    {"4", "7", "0.9982859353368666`", "0.001401656600985714`", 
     "0.0003119700364824579`", "4.380256652597584`*^-7"},
    {"4", "8", "0.997943407044814`", "0.0015726655672811203`", 
     "0.00048316596349066445`", "7.614244141500224`*^-7"},
    {"4", "9", "0.9974084806665203`", "0.0018396713513328074`", 
     "0.0007504637882501904`", "1.3841938967011511`*^-6"},
    {"4", "10", "0.9950508520550758`", "0.0030156126737429477`", 
     "0.0019276931818263917`", "5.842089354727548`*^-6"},
    {"5", "5", "0.9986427738468754`", "0.001326627246852489`", 
     "0.00003055831168717135`", "4.0594584934360516`*^-8"},
    {"5", "6", "0.9984559745466616`", "0.0014423172473417927`", 
     "0.00010156149557517255`", "1.4671042135874644`*^-7"},
    {"5", "7", "0.9982023589021449`", "0.001568933824454631`", 
     "0.00022834836473824987`", "3.589086621582152`*^-7"},
    {"5", "8", "0.9978598592865392`", "0.001739899753514096`", 
     "0.0003995443019682245`", "6.966579786158686`*^-7"},
    {"5", "9", "0.9973249776922476`", "0.0020068383213905383`", 
     "0.0006668421525403722`", "1.3418338214422283`*^-6"},
    {"5", "10", "0.9949675464613199`", "0.0031824833242163827`", 
     "0.001844071803220708`", "5.8984112429396594`*^-6"},
    {"6", "6", "0.9983372202155611`", "0.0016252776011061246`", 
     "0.0000374412295881878`", "6.095374446163017`*^-8"},
    {"6", "7", "0.9981018674189549`", "0.0017700848729021196`", 
     "0.00012782102380540507`", "2.266843376036273`*^-7"},
    {"6", "8", "0.9977594022836266`", "0.0019409990512277912`", 
     "0.00029901697014577506`", "5.816949998422305`*^-7"},
    {"6", "9", "0.9972245745371789`", "0.002207856794061977`", 
     "0.0005663148467875828`", "1.2538219714836325`*^-6"},
    {"6", "10", "0.9948673806346434`", "0.0033831454831949534`", 
     "0.001743544784698063`", "5.929097463559923`*^-6"},
    {"7", "7", "0.9979523897918489`", "0.00199916163130108`", 
     "0.000048351715621328`", "9.686122871843794`*^-8"},
    {"7", "8", "0.997633357439929`", "0.0021933498969159424`", 
     "0.00017291250583168012`", "3.801573233423375`*^-7"},
    {"7", "9", "0.997098597257144`", "0.0024601062197243517`", 
     "0.0004402104075112832`", "1.0861156203458293`*^-6"},
    {"7", "10", "0.9947417011339492`", "0.0036349478030563258`", 
     "0.0016174406719749283`", "5.91039101956531`*^-6"},
    {"8", "8", "0.9974312041831428`", "0.0025002806782605806`", 
     "0.00006834381978149154`", "1.7131881513385131`*^-7"},
    {"8", "9", "0.9969292055991373`", "0.002799336322734019`", 
     "0.00027069796933279434`", "7.601087958780596`*^-7"},
    {"8", "10", "0.9945727098762069`", "0.003973576658863477`", 
     "0.0014479286135202012`", "5.784851409305763`*^-6"},
    {"9", "9", "0.9966136500416081`", "0.0032685032275924725`", 
     "0.00011746150298158`", "3.8522781781799643`*^-7"},
    {"9", "10", "0.9943125398140961`", "0.004495024577770816`", 
     "0.001187069181649096`", "5.3664264839952786`*^-6"},
    {"10", "10", "0.9931268861360085`", "0.005873613697366532`", 
     "0.0009936236151415828`", "5.8765514833954366`*^-6"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.659276422424827*^9, 3.659276477927964*^9}]
}, Closed]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\</home/peter/bio/snail/tsmc/emissions_mma_output.csv\>\"", ",", 
    "emissionsout"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.659276506164536*^9, 3.6592765307504063`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
\[Alpha]\[CloseCurlyQuote]s and \[Beta]\[CloseCurlyQuote]s, \[Gamma], \[Xi] \
check (forward and backward, expected transitions and conditional probs)\
\>", "Section",
 CellChangeTimes->{{3.6592919575101347`*^9, 3.659291970749857*^9}, {
  3.659292083720037*^9, 3.659292087006997*^9}, {3.6593687799933453`*^9, 
  3.659368794486546*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"data", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6592919767120867`*^9, 3.659291988533943*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"alpha", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "numStates"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.659292013698832*^9, 3.65929204022523*^9}, {
  3.659352915730711*^9, 3.659352916299151*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"beta", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "numStates"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.659292057427268*^9, 3.659292073669483*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"normconst", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.659292246571409*^9, 3.6592922620947027`*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"first", " ", "alphas"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.659292232877551*^9, 3.659292237667395*^9}, 
   3.659292272570036*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"idxij", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", "j", ",", 
         RowBox[{"getIndex", "[", 
          RowBox[{"i", ",", "j", ",", "n"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "n"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "i", ",", "n"}], "}"}]}], "]"}], ",", "1"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.659354220485515*^9, 3.659354237384953*^9}, {
   3.659354308887589*^9, 3.659354406533964*^9}, {3.659354550088512*^9, 
   3.659354573739518*^9}, 3.659354640155074*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"pisijidx", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", "j"}], "}"}], ",", 
       RowBox[{
        RowBox[{"i", "=", 
         RowBox[{"getI", "[", "x", "]"}]}], ";", 
        RowBox[{"j", "=", 
         RowBox[{"getJ", "[", "x", "]"}]}], ";", 
        RowBox[{"pi", "[", 
         RowBox[{"i", ",", "j"}], "]"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "1", ",", "numStates"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.659354809970043*^9, 3.659354872822493*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"emitsijidx", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", "j", ",", "t"}], "}"}], ",", 
       RowBox[{
        RowBox[{"i", "=", 
         RowBox[{"getI", "[", "x", "]"}]}], ";", 
        RowBox[{"j", "=", 
         RowBox[{"getJ", "[", "x", "]"}]}], ";", 
        RowBox[{"emit", "[", 
         RowBox[{
          RowBox[{"data", "[", 
           RowBox[{"[", "l", "]"}], "]"}], ",", "i", ",", "j", ",", "Td", ",",
           "\[Theta]"}], "]"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "1", ",", "numStates"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.659354954304867*^9, 3.659354962513863*^9}, {
  3.659354997812046*^9, 3.659355091020137*^9}, {3.659355180458447*^9, 
  3.6593552228560658`*^9}, {3.659355276411529*^9, 3.659355284318671*^9}, {
  3.659355328947114*^9, 3.659355336594738*^9}, {3.659355370102695*^9, 
  3.659355382947196*^9}, {3.659355446039672*^9, 3.6593554645392923`*^9}, {
  3.6593555803588457`*^9, 3.659355731300583*^9}, {3.659355764881852*^9, 
  3.6593558387342777`*^9}, {3.659355886156158*^9, 3.6593558903513308`*^9}, {
  3.659356667906087*^9, 3.6593566959177637`*^9}, {3.6593568942177353`*^9, 
  3.659356908383857*^9}, {3.6593571164810953`*^9, 3.659357123239357*^9}, {
  3.659357322748732*^9, 3.6593573232121277`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"ptsijidx", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"i", "=", 
          RowBox[{"getI", "[", "x", "]"}]}], ";", 
         RowBox[{"j", "=", 
          RowBox[{"getJ", "[", "x", "]"}]}], ";", 
         RowBox[{"k", "=", 
          RowBox[{"getI", "[", "y", "]"}]}], ";", 
         RowBox[{"l", "=", 
          RowBox[{"getJ", "[", "y", "]"}]}], ";", 
         RowBox[{"pts", "[", 
          RowBox[{"i", ",", "j", ",", "k", ",", "l", ",", "\[Rho]"}], 
          "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"x", ",", "1", ",", "numStates"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", "1", ",", "numStates"}], "}"}]}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "\[LessEqual]", "numStates"}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ptsijidx", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "i"}], "]"}], "]"}], "=", 
       RowBox[{"1", "-", 
        RowBox[{"Total", "[", 
         RowBox[{"ptsijidx", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "All"}], "]"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
       "\"\</home/peter/bio/snail/tsmc/ptsijidx_lambdas1.csv\>\"", ",", 
        "ptsijidx"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.659357148333372*^9, 3.659357158133532*^9}, {
  3.659357316104787*^9, 3.659357318721311*^9}, {3.659357432064629*^9, 
  3.659357469452202*^9}, {3.6593576685094223`*^9, 3.6593576954598618`*^9}, {
  3.6593580059917717`*^9, 3.6593580200748587`*^9}, {3.659359276695681*^9, 
  3.659359280363524*^9}, {3.6593595121243277`*^9, 3.659359529484034*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ptsijidx", "=", 
   RowBox[{
   "Import", "[", "\"\</home/peter/bio/snail/tsmc/ptsijidx_lambdas1.csv\>\"", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.659359283494783*^9, 3.659359333754155*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getI", "[", "ijidx_", "]"}], ":=", 
  RowBox[{"idxij", "[", 
   RowBox[{"[", 
    RowBox[{"ijidx", ",", "1"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.659354584852804*^9, 3.659354620140255*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getJ", "[", "ijidx_", "]"}], ":=", 
  RowBox[{"idxij", "[", 
   RowBox[{"[", 
    RowBox[{"ijidx", ",", "2"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.659354584852804*^9, 3.659354623861896*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"alpha1", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"pisijidx", "[", 
       RowBox[{"[", "x", "]"}], "]"}], "*", 
      RowBox[{"emitsijidx", "[", 
       RowBox[{"[", 
        RowBox[{"x", ",", "1"}], "]"}], "]"}]}], " ", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "1", ",", "numStates"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6593546563722153`*^9, 3.659354734972342*^9}, {
   3.6593568489722843`*^9, 3.659356858431994*^9}, {3.659356972916409*^9, 
   3.659357062019339*^9}, 3.659357132127161*^9, 3.659357281616494*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"normconst", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "=", 
   RowBox[{"Total", "[", "alpha1", "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"alpha1", " ", "=", " ", 
   RowBox[{"alpha1", "/", 
    RowBox[{"Total", "[", "alpha1", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.659354749425982*^9, 3.6593547592367*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"alpha", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "All"}], "]"}], "]"}], "=", "alpha1"}], ";"}]], "Input",\

 CellChangeTimes->{{3.659360061555385*^9, 3.659360088954782*^9}}],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ijidx", ",", "s"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"s", "=", "1"}], ",", 
      RowBox[{"s", "\[LessEqual]", "3"}], ",", 
      RowBox[{"s", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ijidx", "=", "1"}], ",", 
         RowBox[{"ijidx", "\[LessEqual]", "numStates"}], ",", 
         RowBox[{"ijidx", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"alpha", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"s", "+", "1"}], ",", "ijidx"}], "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"Total", "[", 
             RowBox[{
              RowBox[{"ptsijidx", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "ijidx"}], "]"}], "]"}], "*", 
              RowBox[{"alpha", "[", 
               RowBox[{"[", 
                RowBox[{"s", ",", "All"}], "]"}], "]"}]}], "]"}], "*", 
            RowBox[{"emitsijidx", "[", 
             RowBox[{"[", 
              RowBox[{"ijidx", ",", 
               RowBox[{"s", "+", "1"}]}], "]"}], "]"}]}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"normconst", "[", 
         RowBox[{"[", 
          RowBox[{"s", "+", "1"}], "]"}], "]"}], "=", 
        RowBox[{"Total", "[", 
         RowBox[{"alpha", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"s", "+", "1"}], ",", "All"}], "]"}], "]"}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"alpha", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"s", "+", "1"}], ",", "All"}], "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"alpha", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"s", "+", "1"}], ",", "All"}], "]"}], "]"}], "/", 
         RowBox[{"normconst", "[", 
          RowBox[{"[", 
           RowBox[{"s", "+", "1"}], "]"}], "]"}]}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQbWIQntHj/NrxffKFfBB9Qu1EOYguOji5F0Q7bTwy
CURP8t47F0THHWdeBKI97NKWg2ifrv3XQfSGqx8eguh1Xzo/gPXVzfsMom94
zPgFomelX/4NovXkbp1dA6SPOL56CKLt9jO+A9G7vi3+AqJn1eb+AdF6TyL+
gegpiySZ1gLpb7z/WEH0rVJRYRD9tEcFTM+JXC4Loid4asqBaLvcGWYgepfe
fXMQLaYnZQeiN63UAdPH/i9ZD6I91xZsANHzElZvAYuv2HgARPdqip4A0V3/
xMD0B9s/N0H09GPvb4FouU6jByDaeuWfJyB68uzaVyA6w7MDTAMAlb21DA==

  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\</home/peter/bio/snail/tsmc/forward_mma.csv\>\"", ",", "alpha"}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.659362183824925*^9, 3.659362203729438*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"beta4", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"1", ",", 
     RowBox[{"{", 
      RowBox[{"ijidx", ",", "1", ",", "numStates"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.65936308239452*^9, 3.6593630957517643`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"beta", "[", 
    RowBox[{"[", 
     RowBox[{"4", ",", "All"}], "]"}], "]"}], "=", "beta4"}], ";"}]], "Input",\

 CellChangeTimes->{{3.659363096608458*^9, 3.6593631014633102`*^9}}],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ijidx", ",", "s"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"s", "=", "3"}], ",", 
     RowBox[{"s", "\[GreaterEqual]", "1"}], ",", 
     RowBox[{"s", "--"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"ijidx", "=", "1"}], ",", 
        RowBox[{"ijidx", "\[LessEqual]", "numStates"}], ",", 
        RowBox[{"ijidx", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"beta", "[", 
           RowBox[{"[", 
            RowBox[{"s", ",", "ijidx"}], "]"}], "]"}], "=", 
          RowBox[{"Total", "[", 
           RowBox[{
            RowBox[{"beta", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"s", "+", "1"}], ",", "All"}], "]"}], "]"}], "*", 
            RowBox[{"ptsijidx", "[", 
             RowBox[{"[", 
              RowBox[{"ijidx", ",", "All"}], "]"}], "]"}], "*", 
            RowBox[{"emitsijidx", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", 
               RowBox[{"s", "+", "1"}]}], "]"}], "]"}]}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"beta", "[", 
        RowBox[{"[", 
         RowBox[{"s", ",", "All"}], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"beta", "[", 
         RowBox[{"[", 
          RowBox[{"s", ",", "All"}], "]"}], "]"}], "/", 
        RowBox[{"normconst", "[", 
         RowBox[{"[", 
          RowBox[{"s", "+", "1"}], "]"}], "]"}]}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.659363130890183*^9, 3.659363373444778*^9}}],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
    "\"\</home/peter/bio/snail/tsmc/backward_mma.csv\>\"", ",", "beta"}], 
    "]"}], ";"}], "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{{3.659363678218793*^9, 3.659363710734079*^9}, {
  3.6593639273865128`*^9, 3.6593639424853687`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"beta", "=", 
   RowBox[{
   "Import", "[", "\"\</home/peter/bio/snail/tsmc/backward_mma.csv\>\"", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.65936394481433*^9, 3.659363961791716*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"normconst", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"this", " ", "matches"}], ",", " ", 
    RowBox[{
     RowBox[{
     "as", " ", "it", " ", "has", " ", "to", " ", "if", " ", "alpha", " ", 
      "and", " ", "beta", " ", "are", " ", "correct"}], "..."}]}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.659364274464859*^9, 3.6593642786557426`*^9}, {
  3.659364348390449*^9, 3.659364358960594*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.9972508887654294`", ",", "0.9972541734575529`", ",", 
   "0.001832990063015161`", ",", "0.9961704055217906`"}], "}"}]], "Output",
 CellChangeTimes->{3.659364278910727*^9, 3.6593643312300367`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"gamma", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"alpha", "[", 
       RowBox[{"[", 
        RowBox[{"s", ",", "ijidx"}], "]"}], "]"}], "*", 
      RowBox[{
       RowBox[{"beta", "[", 
        RowBox[{"[", 
         RowBox[{"s", ",", "ijidx"}], "]"}], "]"}], "/", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{"alpha", "[", 
          RowBox[{"[", 
           RowBox[{"s", ",", "All"}], "]"}], "]"}], "*", 
         RowBox[{"beta", "[", 
          RowBox[{"[", 
           RowBox[{"s", ",", "All"}], "]"}], "]"}]}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "1", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ijidx", ",", "1", ",", "numStates"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6593645033849163`*^9, 3.659364592246026*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
     "\"\</home/peter/bio/snail/tsmc/gamma_mma.csv\>\"", ",", "gamma"}], 
     "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"gamma", " ", "=", " ", 
    RowBox[{
    "Import", "[", "\"\</home/peter/bio/snail/tsmc/gamma_mma.csv\>\"", 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.659363678218793*^9, 3.659363710734079*^9}, {
  3.6593639273865128`*^9, 3.6593639424853687`*^9}, {3.659364825678087*^9, 
  3.6593648285006857`*^9}, {3.659364861079385*^9, 3.6593648905098*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"xi", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"gamma", "[", 
       RowBox[{"[", 
        RowBox[{"s", ",", "ijidx"}], "]"}], "]"}], "*", 
      RowBox[{"ptsijidx", "[", 
       RowBox[{"[", 
        RowBox[{"ijidx", ",", "klidx"}], "]"}], "]"}], "*", 
      RowBox[{"emitsijidx", "[", 
       RowBox[{"[", 
        RowBox[{"klidx", ",", 
         RowBox[{"s", "+", "1"}]}], "]"}], "]"}], 
      RowBox[{
       RowBox[{"beta", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"s", "+", "1"}], ",", "klidx"}], "]"}], "]"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"normconst", "[", 
          RowBox[{"[", 
           RowBox[{"s", "+", "1"}], "]"}], "]"}], "*", 
         RowBox[{"beta", "[", 
          RowBox[{"[", 
           RowBox[{"s", ",", "ijidx"}], "]"}], "]"}]}], ")"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ijidx", ",", "1", ",", "numStates"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"klidx", ",", "1", ",", "numStates"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.65936504955472*^9, 3.659365250935014*^9}, {
  3.6593666569522953`*^9, 3.659366667135428*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", 
  RowBox[{"xi", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.659365252709793*^9, 3.659365253772876*^9}, {
  3.659366676719606*^9, 3.6593666793931637`*^9}}],

Cell[BoxData["66"], "Output",
 CellChangeTimes->{
  3.659365253987193*^9, {3.659366669265896*^9, 3.6593666798245707`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\</home/peter/bio/snail/tsmc/expect_mma.csv\>\"", ",", 
    RowBox[{"Total", "[", 
     RowBox[{"xi", ",", 
      RowBox[{"{", "1", "}"}]}], "]"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.659366527654539*^9, 3.659366631157374*^9}, {
  3.659366687089315*^9, 3.659366730265832*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["loglike test", "Section",
 CellChangeTimes->{{3.659368807894788*^9, 3.659368809699312*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"loglike", "=", 
  RowBox[{
   RowBox[{"Total", "[", 
    RowBox[{
     RowBox[{"gamma", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "All"}], "]"}], "]"}], "*", 
     RowBox[{"Log", "[", 
      RowBox[{"pisijidx", "[", 
       RowBox[{"[", "All", "]"}], "]"}], "]"}]}], "]"}], "+", 
   "\[IndentingNewLine]", 
   RowBox[{"Total", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Log", "[", 
         RowBox[{"emitsijidx", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", "s"}], "]"}], "]"}], "]"}], 
        RowBox[{"gamma", "[", 
         RowBox[{"[", 
          RowBox[{"s", ",", "j"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"s", ",", "1", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "numStates"}], "}"}]}], "]"}], "]"}], 
    "]"}], "+", "\[IndentingNewLine]", 
   RowBox[{"Total", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ptsijidx", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], ">", "0"}], ",", 
          RowBox[{"Log", "[", 
           RowBox[{"ptsijidx", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], ",", "0"}], "]"}], 
        
        RowBox[{"xi", "[", 
         RowBox[{"[", 
          RowBox[{"s", ",", "i", ",", "j"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "numStates"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "numStates"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"s", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.659368811000942*^9, 3.6593688120079937`*^9}, {
  3.659368952791478*^9, 3.659368977683178*^9}, {3.6593690279057817`*^9, 
  3.659369029018568*^9}, {3.659369059600819*^9, 3.659369080683769*^9}, {
  3.659369119332996*^9, 3.659369151441124*^9}, {3.659369222656415*^9, 
  3.6593693119984694`*^9}, {3.659369349729085*^9, 3.659369370322015*^9}, {
  3.659369412263435*^9, 3.6593694727998877`*^9}, {3.659369525354581*^9, 
  3.659369542369564*^9}}],

Cell[BoxData[
 RowBox[{"-", "9.961699826727562`"}]], "Output",
 CellChangeTimes->{3.659368979015175*^9, 3.659369152093951*^9, 
  3.659369312543438*^9, 3.659369352909246*^9, 3.6593694734704113`*^9, 
  3.6593695436090403`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"matches", "..."}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.6593701884674463`*^9, 3.6593701910272837`*^9}}],

Cell[BoxData[" "], "Input",
 CellChangeTimes->{3.6593698213708973`*^9}]
}, Open  ]]
},
WindowSize->{1916, 498},
WindowMargins->{{0, Automatic}, {Automatic, 26}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
ShowSelection->True,
Magnification->1.25,
FrontEndVersion->"10.0 for Linux x86 (64-bit) (December 4, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 150, 2, 84, "Section"],
Cell[732, 26, 203, 4, 39, "Input"],
Cell[938, 32, 491, 14, 39, "Input"],
Cell[CellGroupData[{
Cell[1454, 50, 443, 11, 39, "Input"],
Cell[1900, 63, 2142, 45, 70, "Output"]
}, Open  ]],
Cell[4057, 111, 481, 11, 39, "Input"],
Cell[4541, 124, 246, 6, 39, "Input"],
Cell[4790, 132, 247, 7, 39, "Input"],
Cell[5040, 141, 363, 10, 39, "Input"],
Cell[5406, 153, 290, 8, 39, "Input"],
Cell[5699, 163, 118, 2, 39, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[5854, 170, 129, 1, 66, "Section"],
Cell[5986, 173, 3676, 103, 201, "Input"],
Cell[9665, 278, 302, 6, 39, "Input"],
Cell[9970, 286, 164, 4, 39, "Input"],
Cell[10137, 292, 1670, 43, 67, "Input"],
Cell[11810, 337, 5785, 158, 371, "Input"],
Cell[17598, 497, 1340, 39, 96, "Input"],
Cell[18941, 538, 7264, 200, 497, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[26242, 743, 107, 1, 66, "Section"],
Cell[26352, 746, 37376, 936, 2642, "Input"],
Cell[63731, 1684, 57229, 1505, 3704, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[120997, 3194, 155, 2, 66, "Section"],
Cell[CellGroupData[{
Cell[121177, 3200, 275, 8, 48, "Input"],
Cell[121455, 3210, 119, 2, 48, "Output"]
}, Open  ]],
Cell[121589, 3215, 380, 12, 48, "Input"],
Cell[121972, 3229, 362, 10, 48, "Input"],
Cell[CellGroupData[{
Cell[122359, 3243, 2071, 47, 421, "Input"],
Cell[CellGroupData[{
Cell[124455, 3294, 91, 1, 70, "Print"],
Cell[124549, 3297, 91, 1, 70, "Print"],
Cell[124643, 3300, 93, 1, 70, "Print"],
Cell[124739, 3303, 91, 1, 70, "Print"],
Cell[124833, 3306, 91, 1, 70, "Print"],
Cell[124927, 3309, 93, 1, 70, "Print"],
Cell[125023, 3312, 91, 1, 70, "Print"],
Cell[125117, 3315, 93, 1, 70, "Print"],
Cell[125213, 3318, 91, 1, 70, "Print"],
Cell[125307, 3321, 91, 1, 70, "Print"],
Cell[125401, 3324, 92, 1, 70, "Print"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[125542, 3331, 188, 4, 38, "Input"],
Cell[125733, 3337, 125, 1, 48, "Output"]
}, Open  ]],
Cell[125873, 3341, 415, 11, 48, "Input"],
Cell[CellGroupData[{
Cell[126313, 3356, 2123, 47, 421, "Input"],
Cell[CellGroupData[{
Cell[128461, 3407, 93, 1, 70, "Print"],
Cell[128557, 3410, 93, 1, 70, "Print"],
Cell[128653, 3413, 95, 1, 70, "Print"],
Cell[128751, 3416, 93, 1, 70, "Print"],
Cell[128847, 3419, 93, 1, 70, "Print"],
Cell[128943, 3422, 93, 1, 70, "Print"],
Cell[129039, 3425, 93, 1, 70, "Print"],
Cell[129135, 3428, 93, 1, 70, "Print"],
Cell[129231, 3431, 93, 1, 70, "Print"],
Cell[129327, 3434, 93, 1, 70, "Print"],
Cell[129423, 3437, 94, 1, 70, "Print"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[129566, 3444, 246, 5, 38, "Input"],
Cell[129815, 3451, 127, 1, 93, "Output"]
}, Closed]],
Cell[129957, 3455, 208, 5, 38, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[130202, 3465, 156, 2, 66, "Section"],
Cell[130361, 3469, 1126, 32, 67, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[131524, 3506, 165, 2, 66, "Section"],
Cell[131692, 3510, 4208, 118, 736, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[135937, 3633, 157, 2, 66, "Section"],
Cell[136097, 3637, 349, 10, 39, "Input"],
Cell[136449, 3649, 222, 5, 39, "Input"],
Cell[136674, 3656, 379, 10, 39, "Input"],
Cell[137056, 3668, 315, 11, 39, "Input"],
Cell[137374, 3681, 2199, 54, 364, "Input"],
Cell[CellGroupData[{
Cell[139598, 3739, 188, 3, 39, "Input"],
Cell[139789, 3744, 8716, 147, 2102, "Output"]
}, Closed]],
Cell[148520, 3894, 247, 6, 31, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[148804, 3905, 345, 6, 66, "Section"],
Cell[149152, 3913, 217, 5, 39, "Input"],
Cell[149372, 3920, 400, 11, 39, "Input"],
Cell[149775, 3933, 351, 10, 39, "Input"],
Cell[150129, 3945, 264, 7, 39, "Input"],
Cell[150396, 3954, 185, 4, 39, "Input"],
Cell[150584, 3960, 680, 18, 39, "Input"],
Cell[151267, 3980, 629, 19, 39, "Input"],
Cell[151899, 4001, 1476, 32, 39, "Input"],
Cell[153378, 4035, 2105, 53, 229, "Input"],
Cell[155486, 4090, 238, 6, 39, "Input"],
Cell[155727, 4098, 237, 6, 39, "Input"],
Cell[155967, 4106, 237, 6, 39, "Input"],
Cell[156207, 4114, 624, 16, 39, "Input"],
Cell[156834, 4132, 167, 5, 39, "Input"],
Cell[157004, 4139, 214, 5, 39, "Input"],
Cell[157221, 4146, 226, 7, 39, "Input"],
Cell[157450, 4155, 2634, 70, 256, "Input"],
Cell[160087, 4227, 228, 6, 39, "Input"],
Cell[160318, 4235, 274, 8, 39, "Input"],
Cell[160595, 4245, 226, 7, 39, "Input"],
Cell[160824, 4254, 1787, 47, 229, "Input"],
Cell[162614, 4303, 356, 8, 94, "Input"],
Cell[162973, 4313, 228, 6, 39, "Input"],
Cell[CellGroupData[{
Cell[163226, 4323, 440, 11, 39, "Input"],
Cell[163669, 4336, 240, 5, 39, "Output"]
}, Open  ]],
Cell[163924, 4344, 870, 26, 39, "Input"],
Cell[164797, 4372, 603, 15, 67, "Input"],
Cell[165403, 4389, 1277, 37, 67, "Input"],
Cell[CellGroupData[{
Cell[166705, 4430, 229, 5, 39, "Input"],
Cell[166937, 4437, 122, 2, 39, "Output"]
}, Open  ]],
Cell[167074, 4442, 352, 8, 39, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[167463, 4455, 97, 1, 84, "Section"],
Cell[CellGroupData[{
Cell[167585, 4460, 2280, 61, 94, "Input"],
Cell[169868, 4523, 224, 4, 39, "Output"]
}, Open  ]],
Cell[170107, 4530, 157, 3, 39, "Input"],
Cell[170267, 4535, 71, 1, 39, "Input"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
